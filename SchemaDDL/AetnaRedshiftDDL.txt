CREATE SCHEMA sartpappl_aetna_20181016_new;

COMMIT;

-------------  ACCESS CONTROL  -------------
CREATE TABLE sartpappl_aetna_20181016_new.EDW_ICD9_DIAGNOSIS
(
  ICD9_DX_CD          VARCHAR(8) NULL ENCODE TEXT255,
  ICD9_DX_GROUP_NBR   INTEGER,
  ICD_TYPE_CD         VARCHAR(1) NULL ENCODE TEXT255,
  MDC_CD              VARCHAR(2) NULL ENCODE TEXT255,
  SHORT_DSCRPTN       VARCHAR(60) NULL ENCODE TEXT255,
  ICD9_DX_DSCRPTN     VARCHAR(254) NULL ENCODE TEXT255,
  LOAD_DTM            VARCHAR(12) NULL ENCODE TEXT255
)
DISTSTYLE ALL SORTKEY (ICD9_DX_CD);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.EDW_ICD9_DX_GROUP
(
  ICD9_DX_CTG_CD       INTEGER NULL ENCODE RAW,
  ICD9_DX_GROUP_NBR    INTEGER NULL ENCODE ZSTD,
  ICD9_DXGRP_DSCRPTN   VARCHAR(100) NULL ENCODE ZSTD,
  SHORT_DSCRPTN        VARCHAR(50) NULL ENCODE ZSTD,
  LOAD_DTM             VARCHAR(20) NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (ICD9_DX_CTG_CD);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.EDW_PROCEDURE
(
  DELETE_IND           VARCHAR(1) NULL ENCODE ZSTD,
  ELECTIVE_IND         VARCHAR(1) NULL ENCODE ZSTD,
  ETG_VALID_PRCDR_CD   VARCHAR(5) NULL ENCODE ZSTD,
  ICD9_PRCDR_CD        VARCHAR(7) NULL ENCODE ZSTD,
  ICD10_PRCDR_CD       VARCHAR(7) NULL ENCODE ZSTD,
  PRCDR_CD             VARCHAR(7) NULL ENCODE Raw,
  PRCDR_GROUP_NBR      INTEGER NULL ENCODE ZSTD,
  PRCDR_TYPE_CD        VARCHAR(1) NULL ENCODE ZSTD,
  SHORT_DSCRPTN        VARCHAR(60) NULL ENCODE ZSTD,
  PRCDR_DSCRPTN        VARCHAR(254) NULL ENCODE ZSTD,
  LOAD_DTM             VARCHAR(12) NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (PRCDR_CD);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.EDW_DRUG
(
  AHFS_CD              VARCHAR(6) NULL ENCODE ZSTD,
  DEA_CLASS_CD         VARCHAR(5) NULL ENCODE ZSTD,
  DESI_CD              VARCHAR(1) NULL ENCODE ZSTD,
  DOSAGE_FORM_CD       VARCHAR(4) NULL ENCODE ZSTD,
  DRUG_REPCKGER_CD     VARCHAR(1) NULL ENCODE ZSTD,
  DRUG_STATUS_CD       VARCHAR(1) NULL ENCODE ZSTD,
  EXTENDED_AHFS_CD     VARCHAR(8) NULL ENCODE ZSTD,
  FORMULARY_CD         VARCHAR(1) NULL ENCODE ZSTD,
  GENERIC_CD           VARCHAR(1) NULL ENCODE ZSTD,
  GPI_CD               VARCHAR(14) NULL ENCODE ZSTD,
  GPI_CLASS_CD         VARCHAR(2) NULL ENCODE raw,
  GPI_GROUP_CD         VARCHAR(2) NULL ENCODE raw,
  GPI_NAME_CD          VARCHAR(2) NULL ENCODE ZSTD,
  GPI_NAME_EXT_CD      VARCHAR(2) NULL ENCODE ZSTD,
  GPI_SBCLS_CD         VARCHAR(2) NULL ENCODE ZSTD,
  LABEL_NM             VARCHAR(25) NULL ENCODE ZSTD,
  MAINT_DRUG_CD        VARCHAR(1) NULL ENCODE ZSTD,
  METRIC_STRNGTH_AMT   NUMERIC(14,5) NULL ENCODE ZSTD,
  NDC_CD               VARCHAR(11) NULL ENCODE ZSTD,
  NDC_MNFCTR_CD        VARCHAR(5) NULL ENCODE ZSTD,
  OTC_EQUIVALENT_IND   VARCHAR(1) NULL ENCODE ZSTD,
  REBATE_CTRCT_IND     VARCHAR(1) NULL ENCODE ZSTD,
  ROUTE_ADMIN_CD       VARCHAR(2) NULL ENCODE ZSTD,
  RX_OTC_CD            VARCHAR(1) NULL ENCODE ZSTD,
  THD_PTY_RSTRCTN_CD   VARCHAR(1) NULL ENCODE ZSTD,
  THRPTC_EQUIV_CD      VARCHAR(2) NULL ENCODE ZSTD,
  UNIT_DOSE_CD         VARCHAR(1) NULL ENCODE ZSTD,
  DSCRPTN              VARCHAR(60) NULL ENCODE ZSTD,
  LOAD_DTM             VARCHAR(12) NULL ENCODE ZSTD
)
SORTKEY (GPI_CLASS_CD,GPI_GROUP_CD);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.art_lkup
(
  lkup_cd            VARCHAR(100) NOT NULL ENCODE RAW,
  lkup_column_name   VARCHAR(150) NULL ENCODE RAW,
  lkup_column_cd     VARCHAR(150) NULL ENCODE ZSTD,
  lkup_desc          VARCHAR(150) NULL ENCODE ZSTD,
  data_source        VARCHAR(25) NULL ENCODE ZSTD,
  source_table_nm    VARCHAR(25) NULL ENCODE ZSTD,
  comments           VARCHAR(100) NULL ENCODE ZSTD,
  load_dt_time       VARCHAR(100) NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (LKUP_CD,LKUP_COLUMN_NAME);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ART_LKUP ADD CONSTRAINT ART_LKUP_AETHPK1019_PK PRIMARY KEY (LKUP_CD);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.DIM_TIME_DAY
(
  CDATE                   DATE,
  DAY_NUMBER              INTEGER NULL ENCODE ZSTD,
  DAY_SEQ_NUMBER          INTEGER NULL ENCODE ZSTD,
  DAY                     VARCHAR(10) NULL ENCODE ZSTD,
  DAY_OF_WEEK             INTEGER NULL ENCODE ZSTD,
  DAY_OF_WEEK_IN_MONTH    INTEGER NULL ENCODE ZSTD,
  DAY_OF_MONTH            INTEGER NULL ENCODE ZSTD,
  DAY_OF_YEAR             INTEGER NULL ENCODE ZSTD,
  DAY_ID                  BIGINT NULL ENCODE ZSTD,
  WEEK_NUMBER             INTEGER NULL ENCODE ZSTD,
  WEEK_SEQ_NUMBER         INTEGER NULL ENCODE ZSTD,
  WEEK_OF_MONTH           INTEGER NULL ENCODE ZSTD,
  WEEK_OF_YEAR            INTEGER NULL ENCODE ZSTD,
  WEEK_START_DATE         DATE NULL ENCODE ZSTD,
  WEEK_END_DATE           DATE NULL ENCODE ZSTD,
  WEEK_ID                 BIGINT NULL ENCODE ZSTD,
  MONTH_NUMBER            INTEGER NULL ENCODE ZSTD,
  MONTH_SEQ_NUMBER        INTEGER NULL ENCODE ZSTD,
  MONTH                   VARCHAR(10) NULL ENCODE ZSTD,
  YEAR_MONTH              VARCHAR(15) NULL ENCODE ZSTD,
  MONTH_OF_YEAR           INTEGER NULL ENCODE ZSTD,
  TRAILING_3_MONTH_NAME   VARCHAR(15) NULL ENCODE ZSTD,
  NUM_WEEKS_IN_MONTH      INTEGER NULL ENCODE ZSTD,
  MONTH_ID                BIGINT NULL ENCODE ZSTD,
  QUARTER_NUMBER          INTEGER NULL ENCODE ZSTD,
  QUARTER_SEQ_NUMBER      INTEGER NULL ENCODE ZSTD,
  QUARTER                 VARCHAR(2) NULL ENCODE ZSTD,
  YEAR_QUARTER            VARCHAR(7) NULL ENCODE ZSTD,
  QUARTER_ID              BIGINT NULL ENCODE ZSTD,
  HALF_YEAR_NUMBER        INTEGER NULL ENCODE ZSTD,
  HALF_YEAR_SEQ_NUMBER    INTEGER NULL ENCODE ZSTD,
  HALF                    VARCHAR(2) NULL ENCODE ZSTD,
  YEAR_HALF               VARCHAR(7) NULL ENCODE ZSTD,
  HALF_YEAR_ID            BIGINT NULL ENCODE ZSTD,
  YEAR                    INTEGER NULL ENCODE ZSTD,
  YEAR_SEQ_NUMBER         INTEGER NULL ENCODE ZSTD,
  YEAR_ID                 BIGINT NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (CDATE,DAY,MONTH,YEAR);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.UDF_ART_LKUP
(
  LKUP_CD            VARCHAR(100) NULL ENCODE RAW,
  LKUP_COLUMN_NAME   VARCHAR(150) NULL ENCODE ZSTD,
  LKUP_COLUMN_CD     VARCHAR(100) NULL ENCODE ZSTD,
  LKUP_DESC          VARCHAR(150) NULL ENCODE ZSTD,
  LOAD_DT_TIME       TIMESTAMP NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (LKUP_CD,LKUP_COLUMN_NAME);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.EAPG_DIM
(
  EAPG_KEY                     VARCHAR(32) NOT NULL ENCODE RAW,
  EAPG_TYP_CARE_CD             VARCHAR(3) NULL ENCODE TEXT255,
  EAPG_CTGY_CD                 VARCHAR(3) NULL ENCODE RAW,
  EAPG_GROUP_SERVICE_CTGY_CD   VARCHAR(3) NULL ENCODE TEXT255,
  LOAD_DT_TIME                 DATETIME NULL ENCODE DELTA32K
)
DISTSTYLE ALL SORTKEY (EAPG_KEY,EAPG_CTGY_CD);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.EAPG_DIM ADD CONSTRAINT EAPG_DIM_AETHPK1019_PK PRIMARY KEY (EAPG_KEY);

COMMIT;

-----------------------------------------------------------------------------------
--------                                                                                                   PROVIDER
-----------------------------------------------------------------------------------
CREATE TABLE sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM
(
  PRVDR_ADDRESS_KEY        VARCHAR(32) NOT NULL ENCODE RAW,
  PRVDR_ADDRESS_TYP        VARCHAR(2) NOT NULL ENCODE ZSTD,
  PRVDR_STREET_ADDRESS1    VARCHAR(50) NULL ENCODE ZSTD,
  PRVDR_STREET_ADDRESS2    VARCHAR(50) NULL ENCODE ZSTD,
  PRVDR_CITY               VARCHAR(35) NULL ENCODE ZSTD,
  PRVDR_COUNTY_CD          VARCHAR(30) NULL ENCODE ZSTD,
  PRVDR_STATE              VARCHAR(2) NULL ENCODE BYTEDICT,
  PRVDR_ZIP_CD             VARCHAR(9) NULL ENCODE ZSTD,
  PRVDR_PHONE_NO           NUMERIC(10,0) NULL ENCODE ZSTD,
  PRVDR_FAX_NO             NUMERIC(10,0) NULL ENCODE RAW,
  PRVDR_EMAIL_ADDRESS      VARCHAR(35) NULL ENCODE ZSTD,
  PRVDR_STREET_LEVEL_DPV   VARCHAR(25) NULL ENCODE ZSTD,
  LATITUDE                 VARCHAR(10) NULL ENCODE ZSTD,
  LONGTITUDE               VARCHAR(10) NULL ENCODE ZSTD,
  LOAD_DT_TIME             DATETIME NULL ENCODE ZSTD
)
SORTKEY (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM ADD CONSTRAINT PROVIDER_ADDRESS_AETHPK1019_PK PRIMARY KEY (PRVDR_ADDRESS_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.PROVIDER_DIM
(
  PRVDR_KEY                          VARCHAR(32) NOT NULL ENCODE RAW,
  PRVDR_ID                           VARCHAR(13) NOT NULL ENCODE ZSTD,
  PRVDR_ID_QUAL                      VARCHAR(2) NOT NULL ENCODE ZSTD,
  NETWORK_ID                         VARCHAR(15) NOT NULL ENCODE ZSTD,
  PRVDR_TITLE                        VARCHAR(2) NULL ENCODE ZSTD,
  PRVDR_TYP_CD                       VARCHAR(3) NULL ENCODE ZSTD,
  PRVDR_TYP_DETAILED_CD              VARCHAR(3) NULL ENCODE ZSTD,
  PRVDR_SPECIALTY_CD                 VARCHAR(5) NULL ENCODE ZSTD,
  CMS_TAXONOMY_CD                    VARCHAR(10) NULL ENCODE ZSTD,
  PRVDR_NPI                          VARCHAR(10) NULL ENCODE ZSTD,
  NPI_TYP_CD                         VARCHAR(1) NULL ENCODE ZSTD,
  TAX_ID                             VARCHAR(9) NULL ENCODE ZSTD,
  PRVDR_LICENSE_NO                   VARCHAR(6) NULL ENCODE ZSTD,
  PRVDR_LICENSE_STATE_CD             VARCHAR(6) NULL ENCODE ZSTD,
  PRESCRIBING_DEA_NO                 VARCHAR(9) NULL ENCODE ZSTD,
  PRVDR_LANGUAGE                     VARCHAR(25) NULL ENCODE ZSTD,
  PRVDR_GROUP_ID                     VARCHAR(35) NULL ENCODE ZSTD,
  PRVDR_GROUP_ID_QUAL                VARCHAR(2) NULL ENCODE ZSTD,
  YRS_OF_EXPERIENCE                  NUMERIC(3,0) NULL ENCODE LZO,
  PRVDR_GENDER_CD                    VARCHAR(1) NULL ENCODE ZSTD,
  MEDICALSCHOOL_GRAD_YEAR            NUMERIC(4,0) NULL ENCODE LZO,
  ACCREDITATION_TYP                  VARCHAR(25) NULL ENCODE ZSTD,
  ACCREDITATION_IND                  VARCHAR(1) NULL ENCODE ZSTD,
  BOARD_CERTIFICATION_IND            VARCHAR(1) NULL ENCODE ZSTD,
  NEW_PATIENT_IND                    VARCHAR(1) NULL ENCODE ZSTD,
  NETWORK_IND                        CHAR(1) NULL ENCODE ZSTD,
  TYP_CLASS_CD                       CHAR(1) NULL ENCODE ZSTD,
  VBC_ID                             VARCHAR(10) NULL ENCODE ZSTD,
  VBC_IND                            VARCHAR(1) NULL ENCODE ZSTD,
  PRVDR_QUALITY_PROGRAM_CD           VARCHAR(5) NULL ENCODE ZSTD,
  TELEMEDICINE_IND                   VARCHAR(1) NULL ENCODE ZSTD,
  ERX_IND                            VARCHAR(1) NULL ENCODE ZSTD,
  COE_TYP                            VARCHAR(25) NULL ENCODE ZSTD,
  COE_IND                            VARCHAR(1) NULL ENCODE ZSTD,
  EHR_IND                            VARCHAR(1) NULL ENCODE ZSTD,
  HOSPITAL_ADMITTING_PRIVILEGE_NPI   VARCHAR(10) NULL ENCODE ZSTD,
  PRVDR_STATUS_CD                    VARCHAR(1) NULL ENCODE ZSTD,
  PRVDR_TERMED_IND                   VARCHAR(1) NULL ENCODE ZSTD,
  LOAD_DT_TIME                       DATETIME NULL ENCODE ZSTD,
  PRVDR_BIRTH_DT                     DATE NULL ENCODE ZSTD,
  PRVDR_NETWORK_EFF_DT               DATE NULL ENCODE ZSTD,
  PRVDR_NETWORK_TERM_DT              DATE NULL ENCODE ZSTD,
  VBC_EFF_DT                         DATE NULL ENCODE ZSTD,
  VBC_TERM_DT                        DATE NULL ENCODE ZSTD,
  PRVDR_NM                           VARCHAR(60) NULL ENCODE ZSTD,
  SRVC_SPCLTY_CTGY_CD                VARCHAR(4) NULL ENCODE BYTEDICT
)
SORTKEY (PRVDR_KEY,prvdr_typ_cd,typ_class_cd);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PROVIDER_DIM ADD CONSTRAINT PROVIDER_AETHPK1019_PK PRIMARY KEY (PRVDR_KEY);

COMMIT;

----------------------------------------------------------------------------------
--------                                                                                   ELIGIBILITY
----------------------------------------------------------------------------------
CREATE TABLE sartpappl_aetna_20181016_new.MEMBER_DIM
(
  MEMBER_KEY               VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID             VARCHAR(10) NOT NULL ENCODE ZSTD,
  MEMBER_ID_DEC            VARCHAR(25) NOT NULL ENCODE ZSTD,
  MEMBER_RELATIONSHIP_CD   VARCHAR(1) NULL ENCODE ZSTD,
  PLAN_RELATIONSHIP_CD     VARCHAR(3) NULL ENCODE ZSTD,
  RACE_ETHNICITY           VARCHAR(2) NULL ENCODE ZSTD,
  LOAD_DT_TIME             DATETIME NULL ENCODE ZSTD,
  HIRE_DT                  DATE NULL ENCODE ZSTD,
  MEMBER_BIRTH_DT_DEC      DATE NULL ENCODE DELTA32K,
  ALT_MEMBER_ID_DEC        VARCHAR(30) NULL ENCODE ZSTD,
  ALT_MEMBER_ID_QUAL       VARCHAR(2) NULL ENCODE ZSTD,
  MEMBER_ID_ENC            VARCHAR(25) NOT NULL ENCODE ZSTD,
  MEMBER_BIRTH_DT_ENC      DATE NULL ENCODE ZSTD,
  MEMBER_GENDER_CD         VARCHAR(1) NULL ENCODE ZSTD,
  ALT_MEMBER_ID_ENC        VARCHAR(30)
)
DISTKEY (MEMBER_KEY) SORTKEY (MEMBER_KEY,COMMUNITY_ID);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_DIM ADD CONSTRAINT MEMBER_DIM_AETHPK1019_PK PRIMARY KEY (MEMBER_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.MEMBER_DEMOGRAPHIC_DIM
(
  MEMBER_DEMOGRAPHIC_KEY   VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID             VARCHAR(10) NOT NULL ENCODE ZSTD,
  MEMBER_FIRST_NM_DEC      VARCHAR(25) NULL ENCODE ZSTD,
  MEMBER_LAST_NM_DEC       VARCHAR(40) NULL ENCODE ZSTD,
  MEMBER_PREFIX_NM_DEC     VARCHAR(5) NULL ENCODE ZSTD,
  MEMBER_SUFFIX_NM_DEC     VARCHAR(5) NULL ENCODE ZSTD,
  MEMBER_ADDRESS_1_DEC     VARCHAR(35) NULL ENCODE ZSTD,
  MEMBER_ADDRESS_2_DEC     VARCHAR(35) NULL ENCODE ZSTD,
  MEMBER_CITY_DEC          VARCHAR(35) NULL ENCODE ZSTD,
  MEMBER_COUNTY_CD_DEC     VARCHAR(5) NULL ENCODE BYTEDICT,
  MEMBER_STATE_DEC         VARCHAR(2) NULL ENCODE ZSTD,
  MEMBER_ZIP_CD_DEC        VARCHAR(9) NULL ENCODE ZSTD,
  CENSUS_REGION_CD_DEC     VARCHAR(2) NULL ENCODE ZSTD,
  BUSINESS_LN_CD           VARCHAR(2) NULL ENCODE ZSTD,
  MEMBER_PHONE_NO_DEC      VARCHAR(10) NULL ENCODE ZSTD,
  ZIP_3_DIGIT_DEC          VARCHAR(3) NULL ENCODE ZSTD,
  LOAD_DT_TIME             DATETIME NULL ENCODE ZSTD,
  MEMBER_FIRST_NM_ENC      VARCHAR(25) NULL ENCODE ZSTD,
  MEMBER_LAST_NM_ENC       VARCHAR(40) NULL ENCODE ZSTD,
  MEMBER_PREFIX_NM_ENC     VARCHAR(5) NULL ENCODE ZSTD,
  MEMBER_SUFFIX_NM_ENC     VARCHAR(5) NULL ENCODE ZSTD,
  MEMBER_ADDRESS_1_ENC     VARCHAR(35) NULL ENCODE ZSTD,
  MEMBER_ADDRESS_2_ENC     VARCHAR(35) NULL ENCODE ZSTD,
  MEMBER_CITY_ENC          VARCHAR(35) NULL ENCODE ZSTD,
  MEMBER_COUNTY_CD_ENC     VARCHAR(5) NULL ENCODE BYTEDICT,
  MEMBER_STATE_ENC         VARCHAR(2) NULL ENCODE ZSTD,
  MEMBER_ZIP_CD_ENC        VARCHAR(9) NULL ENCODE ZSTD,
  CENSUS_REGION_CD_ENC     VARCHAR(2) NULL ENCODE ZSTD,
  MEMBER_PHONE_NO_ENC      VARCHAR(10) NULL ENCODE ZSTD,
  ZIP_3_DIGIT_ENC          VARCHAR(3) NULL ENCODE ZSTD,
  MEMBER_COUNTY_NM         VARCHAR(20) NULL ENCODE ZSTD,
  MEMBER_MSA               VARCHAR(100) NULL ENCODE ZSTD,
  MEMBER_COUNTY_NM_ENC     VARCHAR(20) NULL ENCODE ZSTD,
  MEMBER_MSA_ENC           VARCHAR(100) NULL ENCODE ZSTD
)
DISTKEY (MEMBER_DEMOGRAPHIC_KEY) SORTKEY (MEMBER_DEMOGRAPHIC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_DEMOGRAPHIC_DIM ADD CONSTRAINT MEMBER_DEMOGRAPHIC_DIM_AETHPK1019_PK PRIMARY KEY (MEMBER_DEMOGRAPHIC_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.MEMBER_EMPLOYMENT_DIM
(
  MEMBER_EMPLOYMENT_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID                    VARCHAR(10) NOT NULL ENCODE RAW,
  EMPLOYEE_STATUS_CD              VARCHAR(1) NULL ENCODE RAW,
  EMPLOYEE_TYP_CD                 VARCHAR(1) NULL ENCODE RAW,
  SALARY_BAND_CD                  VARCHAR(2) NULL ENCODE RAW,
  EMPLOYEE_EXEMPT_STATUS_CD       VARCHAR(1) NULL ENCODE RAW,
  EMPLOYEE_BARGAINING_STATUS_CD   VARCHAR(1) NULL ENCODE RAW,
  LABOR_UNION_CD                  VARCHAR(3) NULL ENCODE RAW,
  SOCIOECONOMIC_SEGMENT_CD        VARCHAR(1) NULL ENCODE RAW,
  LOAD_DT_TIME                    DATETIME NULL ENCODE RAW
)
DISTSTYLE ALL SORTKEY (MEMBER_EMPLOYMENT_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_EMPLOYMENT_DIM ADD CONSTRAINT MEMBER_EMPLOYMENT_DIM_AETHPK1019_PK PRIMARY KEY (MEMBER_EMPLOYMENT_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.JOB_DIM
(
  JOB_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID      VARCHAR(10) NOT NULL ENCODE ZSTD,
  JOB_CLASS_CD      VARCHAR(3) NULL ENCODE RAW,
  JOB_FAMILY_CD     VARCHAR(3) NULL ENCODE RAW,
  JOB_LOCATION_CD   VARCHAR(3) NULL ENCODE RAW,
  OCCUPATION_CD     VARCHAR(5) NULL ENCODE RAW,
  LOAD_DT_TIME      DATETIME NULL ENCODE RAW
)
DISTSTYLE ALL SORTKEY (JOB_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.JOB_DIM ADD CONSTRAINT JOB_DIM_AETHPK1019_PK PRIMARY KEY (JOB_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.FAMILY_DIM
(
  FAMILY_KEY         VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID       VARCHAR(10) NOT NULL ENCODE ZSTD,
  EMPLOYEE_SSN       VARCHAR(9) NULL ENCODE ZSTD,
  EMPLOYEE_ID        VARCHAR(25) NULL ENCODE ZSTD,
  EMPLOYEE_ID_QUAL   VARCHAR(2) NULL ENCODE ZSTD,
  LOAD_DT_TIME       DATETIME NULL ENCODE ZSTD
)
SORTKEY (FAMILY_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.FAMILY_DIM ADD CONSTRAINT FAMILY_DIM_AETHPK1019_PK PRIMARY KEY (FAMILY_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.MEMBER_CLINICAL_DIM
(
  MEMBER_CLINICAL_KEY    VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID           VARCHAR(10) NOT NULL ENCODE ZSTD,
  SOH_CTGY               VARCHAR(20) NULL ENCODE ZSTD,
  SOH_ACUTE_IND          VARCHAR(1) NULL ENCODE ZSTD,
  SOH_TRAUMA_IND         VARCHAR(1) NULL ENCODE ZSTD,
  SOH_MATERNITY_IND      VARCHAR(1) NULL ENCODE ZSTD,
  TCOC_ELIGIBILITY_IND   VARCHAR(1) NULL ENCODE ZSTD,
  VBC_ID                 VARCHAR(10) NULL ENCODE ZSTD,
  VBC_IND                VARCHAR(1) NULL ENCODE ZSTD,
  LOAD_DT_TIME           DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (MEMBER_CLINICAL_KEY,SOH_CTGY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_CLINICAL_DIM ADD CONSTRAINT MEMBER_CLINICAL_DIM_AETHPK1019_PK PRIMARY KEY (MEMBER_CLINICAL_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.CARRIER_DIM
(
  CARRIER_KEY    VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID   VARCHAR(10) NOT NULL ENCODE ZSTD,
  CARRIER_ID     VARCHAR(5) NULL ENCODE ZSTD,
  LOAD_DT_TIME   DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (CARRIER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.CARRIER_DIM ADD CONSTRAINT CARRIER_DIM_AETHPK1019_PK PRIMARY KEY (CARRIER_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.GROUP_DIM
(
  GROUP_KEY                  VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID               VARCHAR(10) NOT NULL ENCODE RAW,
  GROUP_NO                   VARCHAR(8) NULL ENCODE RAW,
  SUBGROUP_NO                VARCHAR(8) NULL ENCODE RAW,
  ACCOUNT_CD                 VARCHAR(9) NULL ENCODE RAW,
  PLAN_ID                    VARCHAR(5) NULL ENCODE RAW,
  DRUG_BYUP_RIDER_CD         VARCHAR(2) ENCODE RAW,
  DIVISION_CD                VARCHAR(6) NULL ENCODE RAW,
  INDUSTRY_CD                VARCHAR(4) NULL ENCODE RAW,
  FUNDING_ARRANGEMENT_CD     VARCHAR(3) NULL ENCODE TEXT255,
  BROKER                     VARCHAR(40) NULL ENCODE ZSTD,
  CONTROL_PLAN_CD            VARCHAR(5) NULL ENCODE ZSTD,
  LOAD_DT_TIME               DATETIME NULL ENCODE RAW,
  CUST_SUBSGMT_CD            VARCHAR(3) NULL ENCODE ZSTD,
  CUST_SGMT_CD               VARCHAR(3) NULL ENCODE ZSTD,
  CUST_NBR                   CHAR(8) NULL ENCODE ZSTD,
  FUNDING_ARRANGEMENT_DESC   VARCHAR(2) NULL ENCODE RAW
)
DISTSTYLE ALL INTERLEAVED SORTKEY (GROUP_KEY,COMMUNITY_ID,FUNDING_ARRANGEMENT_DESC,GROUP_NO,SUBGROUP_NO,ACCOUNT_CD,PLAN_ID);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.GROUP_DIM ADD CONSTRAINT GROUP_DIM_AETHPK1019_PK PRIMARY KEY (GROUP_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.PLAN_DIM
(
  PLAN_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID       VARCHAR(10) NOT NULL ENCODE ZSTD,
  PLAN_TYP_CD        VARCHAR(5) NULL ENCODE ZSTD,
  PLAN_CD            VARCHAR(5) NULL ENCODE ZSTD,
  PRODUCT_CD         VARCHAR(5) NULL ENCODE ZSTD,
  BENEFIT_CD         VARCHAR(20) NULL ENCODE ZSTD,
  COVERAGE_TIER_CD   VARCHAR(1) NULL ENCODE ZSTD,
  LOAD_DT_TIME       DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (PLAN_KEY,PLAN_TYP_CD);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PLAN_DIM ADD CONSTRAINT PLAN_DIM_AETHPK1019_PK PRIMARY KEY (PLAN_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.STOPLOSS_DIM
(
  STOPLOSS_KEY                   VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID                   VARCHAR(10) NOT NULL ENCODE TEXT255,
  STOPLOSS_TYP_CD                VARCHAR(1) NULL ENCODE ZSTD,
  STOPLOSS_CONTRACT_TERM_CD      VARCHAR(1) NULL ENCODE ZSTD,
  STOPLOSS_TIER_CD               VARCHAR(1) NULL ENCODE ZSTD,
  SPECIFIC_STOPLOSS_DEDUCTIBLE   NUMERIC(9,2) NULL ENCODE ZSTD,
  STOPLOSS_ATTACHMENT_POINT      NUMERIC(9,2) NULL ENCODE ZSTD,
  LOAD_DT_TIME                   DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (STOPLOSS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.STOPLOSS_DIM ADD CONSTRAINT STOPLOSS_DIM_AETHPK1019_PK PRIMARY KEY (STOPLOSS_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.MEMBER_IND_DIM
(
  MEMBER_IND_KEY          VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID            VARCHAR(10) NOT NULL ENCODE ZSTD,
  EXTERNAL_MEDICAL_IND    VARCHAR(1) NULL ENCODE ZSTD,
  EXTERNAL_PHARMACY_IND   VARCHAR(1) NULL ENCODE ZSTD,
  EXTERNAL_DENTAL_IND     VARCHAR(1) NULL ENCODE ZSTD,
  BH_HEALTH_CD            CHAR(1) NULL ENCODE ZSTD,
  MEDICARE_IND            VARCHAR(1) NULL ENCODE ZSTD,
  CLINICAL_PRGM_IND       VARCHAR(1) NULL ENCODE ZSTD,
  LOAD_DT_TIME            DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (MEMBER_IND_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_IND_DIM ADD CONSTRAINT MEMBER_IND_DIM_AETHPK1019_PK PRIMARY KEY (MEMBER_IND_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT
(
  MEMBER_KEY                         VARCHAR(32) NOT NULL ENCODE RAW,
  ELIG_DT                            DATE NOT NULL ENCODE RAW,
  COMMUNITY_ID                       VARCHAR(10) NOT NULL ENCODE ZSTD,
  PLAN_KEY                           VARCHAR(32) NOT NULL ENCODE ZSTD,
  MEMBER_DEMOGRAPHIC_KEY             VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_EMPLOYMENT_KEY              VARCHAR(32) NOT NULL ENCODE ZSTD,
  FAMILY_KEY                         VARCHAR(32) NOT NULL ENCODE ZSTD,
  CARRIER_KEY                        VARCHAR(32) NOT NULL ENCODE ZSTD,
  GROUP_KEY                          VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_CLINICAL_KEY                VARCHAR(32) NOT NULL ENCODE ZSTD,
  JOB_KEY                            VARCHAR(32) NOT NULL ENCODE ZSTD,
  PCP_KEY                            VARCHAR(32) NOT NULL ENCODE ZSTD,
  PCP_ADDRESS_KEY                    VARCHAR(32) NOT NULL ENCODE ZSTD,
  IMPUTED_PRVDR_KEY                  VARCHAR(32) NOT NULL ENCODE ZSTD,
  IMPUTED_PRVDR_ADDRESS_KEY          VARCHAR(32) NOT NULL ENCODE ZSTD,
  STOPLOSS_KEY                       VARCHAR(32) NOT NULL ENCODE ZSTD,
  MEMBER_IND_KEY                     VARCHAR(32) NOT NULL ENCODE ZSTD,
  MEMBER_MONTHS                      NUMERIC(3,0) NULL ENCODE ZSTD,
  DEMOGRAPHIC_RISK_SCORE             NUMERIC(9,4) NULL ENCODE ZSTD,
  HCC_RISK_SCORE                     NUMERIC(5,0) NULL ENCODE LZO,
  ELIGIBILITY_SOURCE_ID              VARCHAR(5) NULL ENCODE ZSTD,
  AGE_GENDER_INDEX                   NUMERIC(3,0) NULL ENCODE LZO,
  LOAD_DT_TIME                       DATETIME NULL ENCODE ZSTD,
  RETROSPECTIVE_RISK_SCORE           NUMERIC(9,4) NULL ENCODE ZSTD,
  PROSPECTIVE_RISK_SCORE             NUMERIC(9,4) NULL ENCODE ZSTD,
  ACTUARIAL_PROSPECTIVE_RISK_SCORE   NUMERIC(9,4) NULL ENCODE ZSTD,
  MEMBER_ID_DEC                      VARCHAR(25) NOT NULL ENCODE ZSTD,
  SRC_ID                             VARCHAR(2) NULL ENCODE ZSTD,
  MEMBER_ID_ENC                      VARCHAR(25) NOT NULL ENCODE ZSTD,
  ELIGIBILITY_IND_KEY                VARCHAR(32) NOT NULL ENCODE ZSTD,
  HPD_DISEASE_KEY                    VARCHAR(32) NOT NULL ENCODE ZSTD,
  MEMBER_CONSU_IQ_KEY                VARCHAR(32) NOT NULL ENCODE ZSTD,
  MEMBER_AGE                         SMALLINT ENCODE ZSTD,
  LOCAL_PLAN_MKT_CD                  VARCHAR(6),
  SES_INDEX_LVL                      NUMERIC(1,0),
  DEN_PLAN_DESIGN_CD                 CHAR(3) NOT NULL ENCODE ZSTD
)
DISTKEY (Member_Demographic_key) SORTKEY (elig_dt);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_AETHPK1019_PK PRIMARY KEY (MEMBER_KEY,ELIG_DT,COMMUNITY_ID,PLAN_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_CARRIER_DIM_AETHPK1019_FK FOREIGN KEY (CARRIER_KEY) REFERENCES sartpappl_aetna_20181016_new.CARRIER_DIM (CARRIER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_FAMILY_DIM_AETHPK1019_FK FOREIGN KEY (FAMILY_KEY) REFERENCES sartpappl_aetna_20181016_new.FAMILY_DIM (FAMILY_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_GROUP_DIM_AETHPK1019_FK FOREIGN KEY (GROUP_KEY) REFERENCES sartpappl_aetna_20181016_new.GROUP_DIM (GROUP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_JOB_DIM_AETHPK1019_FK FOREIGN KEY (JOB_KEY) REFERENCES sartpappl_aetna_20181016_new.JOB_DIM (JOB_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_MEMBER_CLINICAL_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_CLINICAL_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CLINICAL_DIM (MEMBER_CLINICAL_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_MEMBER_DEMOGRAPHIC_AETHPK1019_FK FOREIGN KEY (MEMBER_DEMOGRAPHIC_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DEMOGRAPHIC_DIM (MEMBER_DEMOGRAPHIC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_MEMBER_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DIM (MEMBER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_MEMBER_EMPLOYMENT_AETHPK1019_FK FOREIGN KEY (MEMBER_EMPLOYMENT_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_EMPLOYMENT_DIM (MEMBER_EMPLOYMENT_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_PLAN_DIM_AETHPK1019_FK FOREIGN KEY (PLAN_KEY) REFERENCES sartpappl_aetna_20181016_new.PLAN_DIM (PLAN_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_PROVIDER_DIM_AETHPK1019_FK FOREIGN KEY (IMPUTED_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_PRVDR_DIM_AETHPK1019_FK1 FOREIGN KEY (PCP_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_STOPLOSS_DIM_AETHPK1019_FK FOREIGN KEY (STOPLOSS_KEY) REFERENCES sartpappl_aetna_20181016_new.STOPLOSS_DIM (STOPLOSS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_PROVIDER_ADDRESS_AETHPK1019_FK FOREIGN KEY (PCP_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_PROVIDER_ADDRESS_AETHPK1019_FK1 FOREIGN KEY (IMPUTED_PRVDR_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_MEMBER_INDICATOR_DIM_FK FOREIGN KEY (MEMBER_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_IND_DIM (MEMBER_IND_KEY);

COMMIT;

-------------------------------------------------------------------------------
--------                                                                                   PHARMACY
-------------------------------------------------------------------------------
CREATE TABLE sartpappl_aetna_20181016_new.DRUGS_DIM
(
  DRUG_KEY                 VARCHAR(32) NOT NULL ENCODE RAW,
  NATIONAL_DRUG_CODE       VARCHAR(11) NOT NULL ENCODE ZSTD,
  DRUG_KNOWLEDGE_BANK_CD   VARCHAR(2) NOT NULL ENCODE ZSTD,
  NDC_9_CODE               VARCHAR(9) NULL ENCODE ZSTD,
  DRUG_MANUFACT_DIST       VARCHAR(30) NULL ENCODE ZSTD,
  DEA_CLASS                VARCHAR(2) NULL ENCODE ZSTD,
  DESI_IND                 VARCHAR(1) NULL ENCODE ZSTD,
  PKG_QTY_CD               VARCHAR(6) NULL ENCODE ZSTD,
  PKG_SIZE                 VARCHAR(6) NULL ENCODE ZSTD,
  THERAPEUTIC_CLASS_CD     VARCHAR(6) NULL ENCODE RAW,
  THERAPEUTIC_GROUP_CD     VARCHAR(6) NULL ENCODE RAW,
  MASTER_FORM_CD           VARCHAR(1) NULL ENCODE ZSTD,
  EXCEPTION_DRUG_CD        VARCHAR(1) NULL ENCODE ZSTD,
  DRUG_TYP_CD              VARCHAR(15) NULL ENCODE RAW,
  DETAILED_DRUG_TYP_CD     VARCHAR(16) NULL ENCODE ZSTD,
  DRUG_CLASS_CD            VARCHAR(6) NULL ENCODE ZSTD,
  DRUG_FORM                VARCHAR(40) NULL ENCODE ZSTD,
  DOSAGE                   VARCHAR(30) NULL ENCODE ZSTD,
  GENERIC_ID               VARCHAR(14) NULL ENCODE ZSTD,
  BRAND_NAME               VARCHAR(40) NULL ENCODE ZSTD,
  GENERIC_NAME             VARCHAR(60) NULL ENCODE ZSTD,
  MAINTENANCE_DRUG_CD      VARCHAR(1) NULL ENCODE ZSTD,
  NDC_UNITS_QUAL           VARCHAR(5) NULL ENCODE ZSTD,
  LOAD_DT_TIME             DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (DRUG_KEY,DRUG_TYP_CD,THERAPEUTIC_CLASS_CD,THERAPEUTIC_GROUP_CD);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DRUGS_DIM ADD CONSTRAINT DRUGS_DIM_AETHPK1019_PK PRIMARY KEY (DRUG_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.DRUG_CLAIM_DIM
(
  DRUG_CLAIM_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID             VARCHAR(10) NOT NULL ENCODE zstd,
  REFILL_IND               VARCHAR(1) NULL ENCODE zstd,
  FORMULARY_IND            VARCHAR(1) NULL ENCODE zstd,
  GENERIC_IND              VARCHAR(1) NULL ENCODE zstd,
  MAILORDER_IND            VARCHAR(1) NULL ENCODE RAW,
  COMPOUND_IND             VARCHAR(1) NULL ENCODE zstd,
  SPECIALITY_DRUG_IND      VARCHAR(1) NULL ENCODE zstd,
  DAW_CD                   VARCHAR(1) NULL ENCODE zstd,
  PRESCRIPTION_ORIGIN_CD   VARCHAR(25) NULL ENCODE zstd,
  LOAD_DT_TIME             DATETIME NULL ENCODE zstd
)
SORTKEY (DRUG_CLAIM_KEY,MAILORDER_IND);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DRUG_CLAIM_DIM ADD CONSTRAINT DRUG_CLAIM_DIM_AETHPK1019_PK PRIMARY KEY (DRUG_CLAIM_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.PHARMACY_DIM
(
  PHARMACY_ID        BIGINT NOT NULL ENCODE ZSTD,
  PHARMACY_NABP_ID   VARCHAR(7) NULL ENCODE ZSTD,
  PHARMACY_NAME      VARCHAR(30) NULL ENCODE ZSTD,
  PHARMACY_ZIP       VARCHAR(5) NULL ENCODE ZSTD,
  PHARMACY_COUNTY    VARCHAR(30) NULL ENCODE ZSTD,
  PHARMACY_STATE     VARCHAR(2) NULL ENCODE ZSTD,
  PHARMACY_TYP       VARCHAR(2) NULL ENCODE ZSTD,
  PHARMACY_KEY       VARCHAR(32) NOT NULL ENCODE RAW,
  LOAD_DT_TIME       DATETIME NULL ENCODE ZSTD
)
SORTKEY (PHARMACY_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_DIM ADD CONSTRAINT PHARMACY_DIM_AETHPK1019_PK PRIMARY KEY (PHARMACY_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.CLAIM_TYP_DIM
(
  CLAIM_TYP_KEY   VARCHAR(32) NOT NULL ENCODE RAW,
  CLAIM_TYP_CD    VARCHAR(2) NULL ENCODE RAW
)
DISTSTYLE ALL SORTKEY (CLAIM_TYP_CD);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.CLAIM_TYP_DIM ADD CONSTRAINT CLAIM_TYP_DIM_AETHPK1019_PK PRIMARY KEY (CLAIM_TYP_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT
(
  RX_CLAIM_NO                     VARCHAR(25) NOT NULL ENCODE ZSTD,
  COMMUNITY_ID                    VARCHAR(10) NOT NULL ENCODE ZSTD,
  ADJ_TYP_CD                      VARCHAR(1) NOT NULL ENCODE ZSTD,
  ADJ_SEQ_NO                      NUMERIC(2,0) NOT NULL ENCODE ZSTD,
  DRUG_KEY                        VARCHAR(32) NOT NULL ENCODE RAW,
  DRUG_CLAIM_KEY                  VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_KEY                      VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_DEMOGRAPHIC_KEY          VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_CLINICAL_KEY             VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_EMPLOYMENT_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  FAMILY_KEY                      VARCHAR(32) NOT NULL ENCODE RAW,
  PLAN_KEY                        VARCHAR(32) NOT NULL ENCODE RAW,
  GROUP_KEY                       VARCHAR(32) NOT NULL ENCODE RAW,
  JOB_KEY                         VARCHAR(32) NOT NULL ENCODE RAW,
  CARRIER_KEY                     VARCHAR(32) NOT NULL ENCODE RAW,
  PRESCRIBER_KEY                  VARCHAR(32) NOT NULL ENCODE RAW,
  PRESCRIBER_ADDRESS_KEY          VARCHAR(32) NOT NULL ENCODE RAW,
  PHARMACY_KEY                    VARCHAR(32) NOT NULL ENCODE RAW,
  RX_DISPENSE_DT                  DATE NULL ENCODE RAW,
  RX_SERVICE_DT                   DATE NULL ENCODE RAW,
  RX_PROCESS_DT                   DATE NULL ENCODE RAW,
  RX_PAID_DT                      DATE NULL ENCODE RAW,
  CLAIM_TYP_KEY                   VARCHAR(32) NOT NULL ENCODE RAW,
  RX_BILLED_AMT                   NUMERIC(9,2) NULL ENCODE ZSTD,
  RX_NOT_COVERED                  NUMERIC(9,2) NULL ENCODE LZO,
  RX_NOT_COVERED_REASON           VARCHAR(2) NULL ENCODE ZSTD,
  RX_ALLOWED                      NUMERIC(9,2) NULL ENCODE ZSTD,
  RX_INGREDIENT_COST              NUMERIC(9,2) NULL ENCODE ZSTD,
  DISPENSING_FEE                  NUMERIC(9,2) NULL ENCODE ZSTD,
  RX_SALES_TAX                    NUMERIC(9,2) NULL ENCODE ZSTD,
  RX_DEDUCTIBLE                   NUMERIC(9,2) NULL ENCODE ZSTD,
  RX_COPAYMENT                    NUMERIC(9,2) NULL ENCODE ZSTD,
  RX_COINSURANCE                  NUMERIC(9,2) NULL ENCODE LZO,
  RX_OUTOFPOCKET                  NUMERIC(9,2) NULL ENCODE ZSTD,
  RX_PAID_AMT                     NUMERIC(9,2) NULL ENCODE ZSTD,
  RX_SAVINGS                      NUMERIC(9,2) NULL ENCODE LZO,
  RX_SUBROGATION                  NUMERIC(9,2) NULL ENCODE LZO,
  RX_WC_SAVINGS                   NUMERIC(9,2) NULL ENCODE LZO,
  RX_COB_SAVINGS                  NUMERIC(9,2) NULL ENCODE LZO,
  RX_HRA_AMT                      NUMERIC(9,2) NULL ENCODE LZO,
  RX_MEDICARE_SAVINGS             NUMERIC(9,2) NULL ENCODE LZO,
  RX_PENALTY                      NUMERIC(9,2) NULL ENCODE LZO,
  RX_DISCOUNT                     NUMERIC(9,2) NULL ENCODE LZO,
  RX_DAYS_SUPPLY                  NUMERIC(5,0) NULL ENCODE ZSTD,
  RX_UNITS                        NUMERIC(10,0) NULL ENCODE ZSTD,
  RX_COUNT                        NUMERIC(9,0) NULL ENCODE ZSTD,
  REFILL_NO                       NUMERIC(2,0) NULL ENCODE ZSTD,
  REFILLS_ALLOWED                 NUMERIC(2,0) NULL ENCODE LZO,
  SUGGESTED_WHOLESALE_PRICE       NUMERIC(13,2) NULL ENCODE ZSTD,
  WHOLESALE_ACQ_COST              NUMERIC(13,2) NULL ENCODE ZSTD,
  RX_DIRECT_PRICE                 NUMERIC(9,2) NULL ENCODE ZSTD,
  FEDERAL_UPPER_LIMIT             NUMERIC(9,2) NULL ENCODE ZSTD,
  NAT_AVG_DRUG_ACQ_COST_BRAND     NUMERIC(13,2) NULL ENCODE ZSTD,
  NAT_AVG_DRUG_ACQ_COST_GENERIC   NUMERIC(13,2) NULL ENCODE ZSTD,
  EPISODE_KEY                     VARCHAR(32) NOT NULL ENCODE RAW,
  ELIGIBILITY_TAG_FLAG            VARCHAR(1) NULL ENCODE ZSTD,
  PRESCRIPTION_NO                 VARCHAR(12) NULL ENCODE ZSTD,
  LOAD_DT_TIME                    DATETIME NULL ENCODE ZSTD,
  MEMBER_ID_DEC                   VARCHAR(25) NOT NULL ENCODE ZSTD,
  SRC_ID                          VARCHAR(2) NULL ENCODE ZSTD,
  MEMBER_IND_KEY                  VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_ID_ENC                   VARCHAR(25) NOT NULL ENCODE ZSTD,
  MAINT_CHOICE_CD                 VARCHAR(1) NULL ENCODE ZSTD,
  RX_PROF_SRVC_TAX_AMT            NUMERIC(10,2) NULL ENCODE ZSTD,
  MEMBER_CONSU_IQ_KEY             VARCHAR(32) NOT NULL ENCODE RAW,
  HPD_DISEASE_KEY                 VARCHAR(32) NOT NULL ENCODE RAW,
  ELIGIBILITY_IND_KEY             VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_AGE                      SMALLINT ENCODE ZSTD,
  RX_EXTERNAL_IND                 CHAR(1),
  RX_INCENTIVE_PAID_AMT           NUMERIC(13,2),
  LOCAL_PLAN_MKT_CD               VARCHAR(6),
  SES_INDEX_LVL                   NUMERIC(1,0)
)
DISTKEY (Member_Demographic_key) INTERLEAVED SORTKEY (rx_paid_dt,rx_process_dt,rx_service_dt,rx_dispense_dt);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_AETHPK1019_PK PRIMARY KEY (RX_CLAIM_NO,COMMUNITY_ID,ADJ_TYP_CD,ADJ_SEQ_NO);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_CARRIER_DIM_AETHPK1019_FK FOREIGN KEY (CARRIER_KEY) REFERENCES sartpappl_aetna_20181016_new.CARRIER_DIM (CARRIER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_CLAIM_TYP_DIM_AETHPK1019_FK FOREIGN KEY (CLAIM_TYP_KEY) REFERENCES sartpappl_aetna_20181016_new.CLAIM_TYP_DIM (CLAIM_TYP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_DRUGS_DIM_AETHPK1019_FK FOREIGN KEY (DRUG_KEY) REFERENCES sartpappl_aetna_20181016_new.DRUGS_DIM (DRUG_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_FAMILY_DIM_AETHPK1019_FK FOREIGN KEY (FAMILY_KEY) REFERENCES sartpappl_aetna_20181016_new.FAMILY_DIM (FAMILY_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_GROUP_DIM_AETHPK1019_FK FOREIGN KEY (GROUP_KEY) REFERENCES sartpappl_aetna_20181016_new.GROUP_DIM (GROUP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_JOB_DIM_AETHPK1019_FK FOREIGN KEY (JOB_KEY) REFERENCES sartpappl_aetna_20181016_new.JOB_DIM (JOB_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_MEMBER_CLINICAL_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_CLINICAL_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CLINICAL_DIM (MEMBER_CLINICAL_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_MEMBER_DEMOGRAPHIC_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_DEMOGRAPHIC_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DEMOGRAPHIC_DIM (MEMBER_DEMOGRAPHIC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_MEMBER_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DIM (MEMBER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_MEMBER_EMPLOYMENT_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_EMPLOYMENT_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_EMPLOYMENT_DIM (MEMBER_EMPLOYMENT_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_PHARMACY_DIM_AETHPK1019_FK FOREIGN KEY (PHARMACY_KEY) REFERENCES sartpappl_aetna_20181016_new.PHARMACY_DIM (PHARMACY_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_PLAN_DIM_AETHPK1019_FK FOREIGN KEY (PLAN_KEY) REFERENCES sartpappl_aetna_20181016_new.PLAN_DIM (PLAN_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_PRESCRIPTION_DIM_AETHPK1019_FK FOREIGN KEY (DRUG_CLAIM_KEY) REFERENCES sartpappl_aetna_20181016_new.DRUG_CLAIM_DIM (DRUG_CLAIM_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_PROVIDER_ADDRESS_DIM_AETHPK1019_FK FOREIGN KEY (PRESCRIBER_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_PROVIDER_DIM_AETHPK1019_FK FOREIGN KEY (PRESCRIBER_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_MEMBER_IND_DIM_FK FOREIGN KEY (MEMBER_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_IND_DIM (MEMBER_IND_KEY);

COMMIT;

---------------------------------------------------------------------------------------------
--------                         MEDICAL
---------------------------------------------------------------------------------------------
CREATE TABLE sartpappl_aetna_20181016_new.CLAIM_INFO_DIM
(
  CLAIM_INFO_KEY                VARCHAR(32) NOT NULL ENCODE RAW,
  TYP_OF_BILL_CD                VARCHAR(4) NULL ENCODE ZSTD,
  ADMISSION_TYP_CD              VARCHAR(1) NULL ENCODE ZSTD,
  ADMISSION_SOURCE_CD           VARCHAR(2) NULL ENCODE ZSTD,
  DISCHARGE_STATUS_CD           VARCHAR(2) NULL ENCODE ZSTD,
  STOP_LOSS_CTGY_CD             VARCHAR(2) NULL ENCODE ZSTD,
  STOP_LOSS_IND                 VARCHAR(1) NULL ENCODE ZSTD,
  REFERRAL_IND                  VARCHAR(1) NULL ENCODE ZSTD,
  CLAIM_STATUS_CD               VARCHAR(1) NULL ENCODE RAW,
  SPECIALITY_DRUG_IND           VARCHAR(1) NULL ENCODE ZSTD,
  CAPITATION_IND                VARCHAR(1) NULL ENCODE ZSTD,
  PLACE_OF_SERVICE_CD           VARCHAR(2) NULL ENCODE ZSTD,
  CARRIER_PLACE_OF_SERVICE_CD   VARCHAR(2) NULL ENCODE ZSTD,
  LOAD_DT_TIME                  DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (CLAIM_INFO_KEY,CLAIM_STATUS_CD);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.CLAIM_INFO_DIM ADD CONSTRAINT CLAIM_INFO_DIM_AETHPK1019_PK PRIMARY KEY (CLAIM_INFO_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.CLAIM_NETWORK_DIM
(
  CLAIM_NETWORK_KEY     VARCHAR(32) NOT NULL ENCODE RAW,
  NETWORK_ID            VARCHAR(15) NULL ENCODE ZSTD,
  NETWORK_IND           VARCHAR(1) NULL ENCODE ZSTD,
  PAID_IN_NETWORK_IND   VARCHAR(1) NULL ENCODE ZSTD,
  LOAD_DT_TIME          DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (CLAIM_NETWORK_KEY,NETWORK_IND);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.CLAIM_NETWORK_DIM ADD CONSTRAINT CLAIM_NETWORK_DIM_AETHPK1019_PK PRIMARY KEY (CLAIM_NETWORK_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.CLAIM_PROC_DIM
(
  CLAIM_PROC_KEY                 VARCHAR(32) NOT NULL ENCODE RAW,
  PROC_CD                        VARCHAR(5) NULL ENCODE ZSTD,
  PROC_CD_MODIFIER1              VARCHAR(2) NULL ENCODE BYTEDICT,
  PROC_CD_MODIFIER2              VARCHAR(2) NULL ENCODE BYTEDICT,
  PROC_CD_MODIFIER3              VARCHAR(2) NULL ENCODE ZSTD,
  PROC_CLASS_CD                  VARCHAR(1) NULL ENCODE ZSTD,
  PROC_CTGY_CD                   VARCHAR(4) NULL ENCODE BYTEDICT,
  PROC_GRP_CD                    VARCHAR(3) NULL ENCODE BYTEDICT,
  HEDIS_SELECTED_PROC_CD         VARCHAR(2) NULL ENCODE ZSTD,
  PREFERENCE_SENSITIVE_PROC_CD   VARCHAR(2) NULL ENCODE ZSTD,
  SUPPLY_SENSITIVE_PROC_CD       VARCHAR(2) NULL ENCODE ZSTD,
  PREVENTIVE_CARE_IND            VARCHAR(1) NULL ENCODE ZSTD,
  HEDIS_SCREENING_CD             VARCHAR(2) NULL ENCODE ZSTD,
  LOAD_DT_TIME                   DATETIME NULL ENCODE ZSTD
)
SORTKEY (CLAIM_PROC_KEY,PROC_CD,PROC_CTGY_CD,PROC_GRP_CD);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.CLAIM_PROC_DIM ADD CONSTRAINT CLAIM_PROC_DIM_AETHPK1019_PK PRIMARY KEY (CLAIM_PROC_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.DIAG_DIM
(
  DIAG_KEY                            VARCHAR(32) NOT NULL ENCODE RAW,
  DIAG_01_CD                          VARCHAR(10) NOT NULL ENCODE ZSTD,
  POA_01_CD                           VARCHAR(1) NULL ENCODE ZSTD,
  ICD_VERSION_SUBMITTED               VARCHAR(2) NULL ENCODE ZSTD,
  DIAG_01_ICD9_CODE                   VARCHAR(7) NULL ENCODE ZSTD,
  PREFERENCE_SENSITIVE_CONDITION_CD   VARCHAR(2) NULL ENCODE ZSTD,
  PQI_CD                              VARCHAR(35) NULL ENCODE ZSTD,
  LOW_VALUE_CARE_CTGY_CD              VARCHAR(5) NULL ENCODE ZSTD,
  LOW_VALUE_CARE_SERVICE_CD           VARCHAR(5) NULL ENCODE ZSTD,
  SELF_CARE_DIAG_IND                  VARCHAR(1) NULL ENCODE ZSTD,
  CONDITION_CTGY_CD                   VARCHAR(5) NULL ENCODE ZSTD,
  HIERARCHIAL_CONDITION_CTGY_CD       VARCHAR(5) NULL ENCODE ZSTD,
  DX_GROUP_CD                         VARCHAR(5) NULL ENCODE RAW,
  DX_CTGY_CD                          VARCHAR(10) NULL ENCODE RAW,
  MDC_CD                              VARCHAR(2) NULL ENCODE RAW,
  LOAD_DT_TIME                        DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (DIAG_KEY,MDC_CD,DX_GROUP_CD,DX_CTGY_CD);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DIAG_DIM ADD CONSTRAINT DIAG_DIM_AETHPK1019_PK PRIMARY KEY (DIAG_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.EMERGENCY_DIM
(
  EMERGENCY_KEY            VARCHAR(32) NOT NULL ENCODE RAW,
  NYU_EMERGENT_STATUS_CD   VARCHAR(2) NULL ENCODE RAW,
  ER_OBSERVATION_IND       VARCHAR(1) NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (EMERGENCY_KEY,NYU_EMERGENT_STATUS_CD);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.EMERGENCY_DIM ADD CONSTRAINT EMERGENCY_DIM_AETHPK1019_PK PRIMARY KEY (EMERGENCY_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.SECONDARY_DIAG_DIM
(
  SECONDARY_DIAG_KEY   VARCHAR(32) NOT NULL ENCODE RAW,
  DIAG_02_CD           VARCHAR(10) NULL ENCODE ZSTD,
  DIAG_03_CD           VARCHAR(10) NULL ENCODE ZSTD,
  DIAG_04_CD           VARCHAR(10) NULL ENCODE ZSTD,
  DIAG_05_CD           VARCHAR(10) NULL ENCODE ZSTD,
  DIAG_06_CD           VARCHAR(10) NULL ENCODE ZSTD,
  DIAG_07_CD           VARCHAR(10) NULL ENCODE ZSTD,
  DIAG_08_CD           VARCHAR(10) NULL ENCODE ZSTD,
  DIAG_09_CD           VARCHAR(10) NULL ENCODE ZSTD,
  DIAG_10_CD           VARCHAR(10) NULL ENCODE ZSTD,
  DIAG_11_CD           VARCHAR(10) NULL ENCODE ZSTD,
  DIAG_12_CD           VARCHAR(10) NULL ENCODE ZSTD,
  POA_02_CD            CHAR(1) NULL ENCODE ZSTD,
  POA_03_CD            CHAR(1) NULL ENCODE ZSTD,
  POA_04_CD            CHAR(1) NULL ENCODE ZSTD,
  POA_05_CD            CHAR(1) NULL ENCODE ZSTD,
  POA_06_CD            CHAR(1) NULL ENCODE ZSTD,
  POA_07_CD            CHAR(1) NULL ENCODE ZSTD,
  POA_08_CD            CHAR(1) NULL ENCODE ZSTD,
  POA_09_CD            CHAR(1) NULL ENCODE ZSTD,
  POA_10_CD            CHAR(1) NULL ENCODE ZSTD,
  POA_11_CD            CHAR(1) NULL ENCODE ZSTD,
  POA_12_CD            CHAR(1) NULL ENCODE ZSTD,
  LOAD_DT_TIME         DATETIME NULL ENCODE ZSTD
)
SORTKEY (SECONDARY_DIAG_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.SECONDARY_DIAG_DIM ADD CONSTRAINT SECONDARY_DIAG_DIM_AETHPK1019_PK PRIMARY KEY (SECONDARY_DIAG_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.SERVICE_TYPE_DIM
(
  SERVICE_TYP_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  SERVICE_TYP_CD            VARCHAR(5) NULL ENCODE RAW,
  CARRIER_SERVICE_TYP_CD    VARCHAR(40) NULL ENCODE ZSTD,
  DETAILED_SERVICE_TYP_CD   VARCHAR(5) NULL ENCODE ZSTD,
  REVENUE_CD                VARCHAR(4) NULL ENCODE ZSTD,
  LOAD_DT_TIME              DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (SERVICE_TYP_KEY,SERVICE_TYP_CD);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.SERVICE_TYPE_DIM ADD CONSTRAINT SERVICE_TYPE_DIM_AETHPK1019_PK PRIMARY KEY (SERVICE_TYP_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.SURGICAL_PROC_DIM
(
  SURGICAL_PROC_KEY   VARCHAR(32) NOT NULL ENCODE RAW,
  ICD_PROC_01_CD      VARCHAR(7) NULL ENCODE ZSTD,
  ICD9_PROC_01_CD     VARCHAR(7) NULL ENCODE ZSTD,
  ICD_PROC_02_CD      VARCHAR(7) NULL ENCODE ZSTD,
  ICD_PROC_03_CD      VARCHAR(7) NULL ENCODE ZSTD,
  ICD_PROC_04_CD      VARCHAR(7) NULL ENCODE ZSTD,
  ICD_PROC_05_CD      VARCHAR(7) NULL ENCODE ZSTD,
  ICD_PROC_06_CD      VARCHAR(7) NULL ENCODE ZSTD,
  ICD_PROC_07_CD      VARCHAR(7) NULL ENCODE ZSTD,
  ICD_PROC_08_CD      VARCHAR(7) NULL ENCODE ZSTD,
  ICD_PROC_09_CD      VARCHAR(7) NULL ENCODE ZSTD,
  ICD_PROC_10_CD      VARCHAR(7) NULL ENCODE ZSTD,
  ICD_PROC_11_CD      VARCHAR(7) NULL ENCODE ZSTD,
  ICD_PROC_12_CD      VARCHAR(7) NULL ENCODE ZSTD,
  LOAD_DT_TIME        DATETIME NULL ENCODE ZSTD
)
SORTKEY (SURGICAL_PROC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.SURGICAL_PROC_DIM ADD CONSTRAINT SURGICAL_PROC_DIM_AETHPK1019_PK PRIMARY KEY (SURGICAL_PROC_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT
(
  COMMUNITY_ID                  VARCHAR(10) NOT NULL ENCODE ZSTD,
  CLAIM_ID                      VARCHAR(25) NOT NULL ENCODE ZSTD,
  CLAIM_LN_ID                   VARCHAR(15) NOT NULL ENCODE ZSTD,
  ADJ_SEQ_NO                    NUMERIC(2,0) NOT NULL ENCODE ZSTD,
  ADJ_TYP_CD                    VARCHAR(1) NOT NULL ENCODE ZSTD,
  CLAIM_INFO_KEY                VARCHAR(32) NOT NULL ENCODE RAW,
  CLAIM_NETWORK_KEY             VARCHAR(32) NOT NULL ENCODE RAW,
  SERVICE_TYP_KEY               VARCHAR(32) NOT NULL ENCODE RAW,
  EAPG_KEY                      VARCHAR(32) NOT NULL ENCODE RAW,
  CLAIM_PROC_KEY                VARCHAR(32) NOT NULL ENCODE RAW,
  DIAG_KEY                      VARCHAR(32) NOT NULL ENCODE RAW,
  SECONDARY_DIAG_KEY            VARCHAR(32) NOT NULL ENCODE RAW,
  SURGICAL_PROC_KEY             VARCHAR(32) NOT NULL ENCODE RAW,
  CLAIM_TYP_KEY                 VARCHAR(32) NOT NULL ENCODE RAW,
  SERVICE_START_DT              DATE NULL ENCODE RAW,
  SERVICE_END_DT                DATE NULL ENCODE ZSTD,
  PAID_DT                       DATE NULL ENCODE RAW,
  PROCESS_DT                    DATE NULL ENCODE RAW,
  MEMBER_KEY                    VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_IND_KEY                VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_DEMOGRAPHIC_KEY        VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_CLINICAL_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  JOB_KEY                       VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_EMPLOYMENT_KEY         VARCHAR(32) NOT NULL ENCODE RAW,
  FAMILY_KEY                    VARCHAR(32) NOT NULL ENCODE RAW,
  PLAN_KEY                      VARCHAR(32) NOT NULL ENCODE RAW,
  GROUP_KEY                     VARCHAR(32) NOT NULL ENCODE RAW,
  STOPLOSS_KEY                  VARCHAR(32) NOT NULL ENCODE RAW,
  EMERGENCY_KEY                 VARCHAR(32) NOT NULL ENCODE RAW,
  PRVDR_KEY                     VARCHAR(32) NOT NULL ENCODE RAW,
  ADMITTING_PRVDR_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  ATTENDING_PRVDR_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  BILLING_PRVDR_KEY             VARCHAR(32) NOT NULL ENCODE RAW,
  BILLING_PRVDR_ADDRESS_KEY     VARCHAR(32) NOT NULL ENCODE RAW,
  REFERRING_PRVDR_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  SERVICING_PRVDR_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  SERVICING_PRVDR_ADDRESS_KEY   VARCHAR(32) NOT NULL ENCODE RAW,
  CARRIER_KEY                   VARCHAR(32) NOT NULL ENCODE RAW,
  ADMISSION_ID                  VARCHAR(25) NOT NULL ENCODE ZSTD,
  EPISODE_KEY                   VARCHAR(32) NOT NULL ENCODE RAW,
  MED_BILLED_AMT                NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_NOT_COVERED_AMT           NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_ALLOWED_AMT               NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_DISCOUNT_AMT              NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_PENALTY_AMT               NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_DEDUCTIBLE_AMT            NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_COPAYMENT_AMT             NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_COINSURANCE_AMT           NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_COB_AMT                   NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_PAID_AMT                  NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_PLAN_LIABILITY_AMT        NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_SURCHARGE_AMT             NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_ACCESS_FEE                NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_SUBROGATION_AMT           NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_STOP_LOSS_AMT             NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_TCCRV_AMT                 NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_WITH_HOLD_AMT             NUMERIC(9,2) NULL ENCODE ZSTD,
  MED_WITH_HOLD_CD              VARCHAR(2) NULL ENCODE ZSTD,
  MED_DAYS                      NUMERIC(5,2) NULL ENCODE ZSTD,
  MED_SERVICES_COUNT            NUMERIC(5,0) NULL ENCODE ZSTD,
  VISIT_ID                      VARCHAR(10) NULL ENCODE ZSTD,
  VISIT_COUNT                   NUMERIC(5,0) NULL ENCODE ZSTD,
  NDC_CD                        CHAR(11) NULL ENCODE ZSTD,
  NYU_ERINAPPROPRIATE_PROB      NUMERIC(5,0) NULL ENCODE ZSTD,
  UNIT_COUNT                    NUMERIC(5,0) NULL ENCODE ZSTD,
  EAPG_INDEX                    NUMERIC(9,2) NULL ENCODE ZSTD,
  ELIG_TAG_FLG_CD               VARCHAR(1) NULL ENCODE ZSTD,
  LOAD_DT_TIME                  DATETIME NULL ENCODE ZSTD,
  MED_HRA_AMT                   NUMERIC(9,2) NULL ENCODE ZSTD,
  MEMBER_ID_DEC                 VARCHAR(25) NOT NULL ENCODE ZSTD,
  SRC_ID                        VARCHAR(2) NULL ENCODE ZSTD,
  MED_COB_SVNGS_AMT             NUMERIC(10,2) NULL ENCODE ZSTD,
  MED_ADMIN_SVNGS_AMT           NUMERIC(10,2) NULL ENCODE ZSTD,
  REIM_TYP_CD                   CHAR(1) ENCODE ZSTD,
  MED_RC_SVNGS_AMT              NUMERIC(10,2) NULL ENCODE ZSTD,
  MED_NEGOT_SVNGS_AMT           NUMERIC(10,2) NULL ENCODE ZSTD,
  COB_TYP_CD                    CHAR(1) ENCODE ZSTD,
  COB_CD                        CHAR(1) ENCODE ZSTD,
  NON_PREFERRED_SVC_CD          CHAR(1) ENCODE ZSTD,
  MED_COMPLETED_PAID_AMT        NUMERIC(15,2) NULL ENCODE ZSTD,
  MEMBER_ID_ENC                 VARCHAR(25) NOT NULL ENCODE ZSTD,
  ELIGIBILITY_IND_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  HPD_DISEASE_KEY               VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_CONSU_IQ_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_AGE                    SMALLINT ENCODE ZSTD,
  LOCAL_PLAN_MKT_CD             VARCHAR(6),
  SES_INDEX_LVL                 NUMERIC(1,0),
  SERVICING_PRVDR_NETWORK_ID    VARCHAR(5) NOT NULL ENCODE ZSTD,
  MED_PROC_CD                   CHAR(7) NOT NULL ENCODE ZSTD
)
DISTKEY (Member_Demographic_key) INTERLEAVED SORTKEY (paid_dt,service_start_dt,process_dt);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_AETHPK1019_PK PRIMARY KEY (CLAIM_ID,CLAIM_LN_ID,ADJ_TYP_CD,ADJ_SEQ_NO,COMMUNITY_ID);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_CARRIER_DIM_AETHPK1019_FK FOREIGN KEY (CARRIER_KEY) REFERENCES sartpappl_aetna_20181016_new.CARRIER_DIM (CARRIER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_CLAIM_INFO_DIM_AETHPK1019_FK FOREIGN KEY (CLAIM_INFO_KEY) REFERENCES sartpappl_aetna_20181016_new.CLAIM_INFO_DIM (CLAIM_INFO_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_CLAIM_NETWORK_DIM_AETHPK1019_FK FOREIGN KEY (CLAIM_NETWORK_KEY) REFERENCES sartpappl_aetna_20181016_new.CLAIM_NETWORK_DIM (CLAIM_NETWORK_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_CLAIM_PROC_DIM_AETHPK1019_FK FOREIGN KEY (CLAIM_PROC_KEY) REFERENCES sartpappl_aetna_20181016_new.CLAIM_PROC_DIM (CLAIM_PROC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_CLAIM_TYP_DIM_AETHPK1019_FK FOREIGN KEY (CLAIM_TYP_KEY) REFERENCES sartpappl_aetna_20181016_new.CLAIM_TYP_DIM (CLAIM_TYP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_DIAG_DIM_AETHPK1019_FK FOREIGN KEY (DIAG_KEY) REFERENCES sartpappl_aetna_20181016_new.DIAG_DIM (DIAG_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_EAPG_DIM_AETHPK1019_FK FOREIGN KEY (EAPG_KEY) REFERENCES sartpappl_aetna_20181016_new.EAPG_DIM (EAPG_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_EMERGENCY_DIM_AETHPK1019_FK FOREIGN KEY (EMERGENCY_KEY) REFERENCES sartpappl_aetna_20181016_new.EMERGENCY_DIM (EMERGENCY_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_FAMILY_DIM_AETHPK1019_FK FOREIGN KEY (FAMILY_KEY) REFERENCES sartpappl_aetna_20181016_new.FAMILY_DIM (FAMILY_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_GROUP_DIM_AETHPK1019_FK FOREIGN KEY (GROUP_KEY) REFERENCES sartpappl_aetna_20181016_new.GROUP_DIM (GROUP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_JOB_DIM_AETHPK1019_FK FOREIGN KEY (JOB_KEY) REFERENCES sartpappl_aetna_20181016_new.JOB_DIM (JOB_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_MEMBER_CLINICAL_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_CLINICAL_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CLINICAL_DIM (MEMBER_CLINICAL_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_MEMBER_DEMOGRAPHIC_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_DEMOGRAPHIC_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DEMOGRAPHIC_DIM (MEMBER_DEMOGRAPHIC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_MEMBER_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DIM (MEMBER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_MEMBER_EMPLOYMENT_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_EMPLOYMENT_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_EMPLOYMENT_DIM (MEMBER_EMPLOYMENT_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_PLAN_DIM_AETHPK1019_FK FOREIGN KEY (PLAN_KEY) REFERENCES sartpappl_aetna_20181016_new.PLAN_DIM (PLAN_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_PRVDR_ADDRESS_DIM_AETHPK1019_FK FOREIGN KEY (BILLING_PRVDR_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_PRVDR_ADDRESS_DIM_AETHPK1019_FK1 FOREIGN KEY (SERVICING_PRVDR_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_PVDR_DIM_AETHPK1019_FK FOREIGN KEY (ATTENDING_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_PVDR_DIM_AETHPK1019_FK1 FOREIGN KEY (BILLING_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_PVDR_DIM_AETHPK1019_FK2 FOREIGN KEY (REFERRING_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_PVDR_DIM_AETHPK1019_FK3 FOREIGN KEY (SERVICING_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_PVDR_DIM_AETHPK1019_FK4 FOREIGN KEY (ADMITTING_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_PVDR_DIM_AETHPK1019_FK5 FOREIGN KEY (PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_SECONDARY_DIAG_DIM_AETHPK1019_FK FOREIGN KEY (SECONDARY_DIAG_KEY) REFERENCES sartpappl_aetna_20181016_new.SECONDARY_DIAG_DIM (SECONDARY_DIAG_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_SERVICE_TYPE_DIM_AETHPK1019_FK FOREIGN KEY (SERVICE_TYP_KEY) REFERENCES sartpappl_aetna_20181016_new.SERVICE_TYPE_DIM (SERVICE_TYP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_STOPLOSS_DIM_AETHPK1019_FK FOREIGN KEY (STOPLOSS_KEY) REFERENCES sartpappl_aetna_20181016_new.STOPLOSS_DIM (STOPLOSS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_SURGICAL_PROC_DIM_AETHPK1019_FK FOREIGN KEY (SURGICAL_PROC_KEY) REFERENCES sartpappl_aetna_20181016_new.SURGICAL_PROC_DIM (SURGICAL_PROC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_MEMBER_IND_DIM_FK FOREIGN KEY (MEMBER_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_IND_DIM (MEMBER_IND_KEY);

COMMIT;

----------------------------------------------------------------------------------------------
--------                                                                                   DENTAL
----------------------------------------------------------------------------------------------
CREATE TABLE sartpappl_aetna_20181016_new.DENTAL_DIM
(
  DEN_KEY             VARCHAR(32) NOT NULL ENCODE RAW,
  TOOTH_CD            CHAR(2) NULL ENCODE zstd,
  TOOTH_QUAD_CD       CHAR(2) NULL ENCODE zstd,
  TOOTH_SURFACE_CD1   CHAR(1) NULL ENCODE ZSTD,
  TOOTH_SURFACE_CD2   CHAR(1) NULL ENCODE ZSTD,
  TOOTH_SURFACE_CD3   CHAR(1) NULL ENCODE ZSTD,
  TOOTH_SURFACE_CD4   CHAR(1) NULL ENCODE ZSTD,
  TOOTH_SURFACE_CD5   CHAR(1) NULL ENCODE ZSTD,
  LOAD_DT_TIME        TIMESTAMP NULL ENCODE zstd
)
DISTSTYLE ALL SORTKEY (DEN_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_DIM ADD CONSTRAINT DENTAL_DIM_PK PRIMARY KEY (DEN_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIM_INFO_DIM
(
  DEN_CLAIM_INFO_KEY   VARCHAR(32) NOT NULL ENCODE RAW,
  STOP_LOSS_IND        CHAR(1) NULL ENCODE zstd,
  STOP_LOSS_CTGY_CD    CHAR(2) NULL ENCODE zstd,
  LOAD_DT_TIME         TIMESTAMP NULL ENCODE zstd
)
DISTSTYLE ALL SORTKEY (DEN_CLAIM_INFO_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIM_INFO_DIM ADD CONSTRAINT DENTAL_CLAIM_INFO_DIM_PK PRIMARY KEY (DEN_CLAIM_INFO_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT
(
  DEN_CLAIM_ID                  VARCHAR(25) NOT NULL ENCODE ZSTD,
  DEN_CLAIM_LN_ID               VARCHAR(15) NOT NULL ENCODE ZSTD,
  COMMUNITY_ID                  CHAR(10) NOT NULL ENCODE ZSTD,
  ADJ_TYP_CD                    CHAR(1) NOT NULL ENCODE ZSTD,
  ADJ_SEQ_NO                    INT NOT NULL ENCODE ZSTD,
  CARRIER_KEY                   VARCHAR(32) NOT NULL ENCODE TEXT255,
  MEMBER_KEY                    VARCHAR(32) NOT NULL ENCODE TEXT255,
  MEMBER_DEMOGRAPHIC_KEY        VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_EMPLOYMENT_KEY         VARCHAR(32) NOT NULL ENCODE TEXT255,
  JOB_KEY                       VARCHAR(32) NOT NULL ENCODE TEXT255,
  FAMILY_KEY                    VARCHAR(32) NOT NULL ENCODE TEXT255,
  PLAN_KEY                      VARCHAR(32) NOT NULL ENCODE TEXT255,
  GROUP_KEY                     VARCHAR(32) NOT NULL ENCODE TEXT255,
  CLAIM_TYP_KEY                 VARCHAR(32) NOT NULL ENCODE TEXT255,
  SERVICING_PRVDR_KEY           VARCHAR(32) NOT NULL ENCODE TEXT255,
  SERVICING_PRVDR_ADDRESS_KEY   VARCHAR(32) NOT NULL ENCODE TEXT255,
  BILLING_PRVDR_KEY             VARCHAR(32) NOT NULL ENCODE TEXT255,
  BILLING_PRVDR_ADDRESS_KEY     VARCHAR(32) NOT NULL ENCODE TEXT255,
  CLAIM_NETWORK_KEY             VARCHAR(32) NOT NULL ENCODE TEXT255,
  CLAIM_PROC_KEY                VARCHAR(32) NOT NULL ENCODE TEXT255,
  STOPLOSS_KEY                  VARCHAR(32) NOT NULL ENCODE TEXT255,
  DEN_KEY                       VARCHAR(32) NOT NULL ENCODE TEXT255,
  DEN_CLAIM_INFO_KEY            VARCHAR(32) NOT NULL ENCODE TEXT255,
  MEMBER_ID_DEC                 VARCHAR(25) ENCODE ZSTD,
  DEN_SERVICE_DT                DATE NULL ENCODE RAW,
  DEN_PROCESS_DT                DATE NULL ENCODE RAW,
  DEN_PAID_DT                   DATE NULL ENCODE RAW,
  DEN_ELIG_TAG_FLG_CD           CHAR(1) NULL ENCODE ZSTD,
  CLAIM_LN_MSG_CD               CHAR(4) NULL ENCODE ZSTD,
  DEN_UNITS                     INT ENCODE ZSTD,
  DEN_BILLED_AMT                NUMERIC(9,2) NULL ENCODE ZSTD,
  DEN_NOT_COVERED_AMT           NUMERIC(9,2) NULL ENCODE ZSTD,
  DEN_ALLOWED_AMT               NUMERIC(9,2) NULL ENCODE ZSTD,
  DEN_DISCOUNT_AMT              NUMERIC(9,2) NULL ENCODE RAW,
  DEN_PENALTY_AMT               NUMERIC(9,2) NULL ENCODE ZSTD,
  DEN_DEDUCTIBLE_AMT            NUMERIC(9,2) NULL ENCODE ZSTD,
  DEN_COPAY_AMT                 NUMERIC(9,2) NULL ENCODE ZSTD,
  DEN_COINSURANCE_AMT           NUMERIC(9,2) NULL ENCODE ZSTD,
  DEN_OUT_OF_POCKET_AMT         NUMERIC(9,2) NULL ENCODE ZSTD,
  DEN_COB_AMT                   NUMERIC(9,2) NULL ENCODE ZSTD,
  DEN_PAID_AMT                  NUMERIC(9,2) NULL ENCODE ZSTD,
  DEN_PLAN_LIAB_AMT             NUMERIC(9,2) NULL ENCODE RAW,
  DEN_HSA_AMOUNT                NUMERIC(9,2) NULL ENCODE RAW,
  DEN_HRA_AMOUNT                NUMERIC(9,2) NULL ENCODE RAW,
  DEN_STOPLOSS_AMT              NUMERIC(9,2) NULL ENCODE RAW,
  DEN_WITHHOLD_AMT              NUMERIC(9,2) NULL ENCODE ZSTD,
  DEN_WITHHOLD_CD               CHAR(2) NULL ENCODE ZSTD,
  DEN_SUBROGATION_AMT           NUMERIC(9,2) NULL ENCODE RAW,
  DEN_SAVINGS_AMT               NUMERIC(9,2) NULL ENCODE RAW,
  DEN_SERVICES_AMT              NUMERIC(9,2) NULL ENCODE RAW,
  DEN_CLAIMANTS                 INT ENCODE RAW,
  DEN_COB_TYP_CD                CHAR(1) NULL ENCODE ZSTD,
  DEN_ACCESS_FEE_AMT            NUMERIC(9,2) NULL ENCODE RAW,
  DEN_RMBRSMNT_TYP_CD           CHAR(1) NULL ENCODE ZSTD,
  DEN_RC_SAVINGS_AMT            NUMERIC(9,2) NULL ENCODE ZSTD,
  DEN_COB_SAVINGS_AMT           NUMERIC(9,2) NULL ENCODE ZSTD,
  DEN_SERVICE_BENEFIT_CD        CHAR(3) NULL ENCODE ZSTD,
  DEN_ADMIN_SAVINGS_AMT         NUMERIC(9,2) NULL ENCODE ZSTD,
  SRC_ID                        CHAR(2) NULL ENCODE ZSTD,
  LOAD_DT_TIME                  TIMESTAMP NULL ENCODE ZSTD,
  MEMBER_ID_ENC                 VARCHAR(25) NOT NULL ENCODE ZSTD,
  MEMBER_CONSU_IQ_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  HPD_DISEASE_KEY               VARCHAR(32) NOT NULL ENCODE RAW,
  ELIGIBILITY_IND_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_AGE                    SMALLINT ENCODE ZSTD,
  LOCAL_PLAN_MKT_CD             VARCHAR(6) NULL ENCODE ZSTD,
  SES_INDEX_LVL                 NUMERIC(1,0) NULL ENCODE ZSTD,
  DEN_NEGOT_SVNGS_AMT           NUMERIC(10,2) NOT NULL ENCODE ZSTD
)
DISTKEY (Member_Demographic_key) INTERLEAVED SORTKEY (den_paid_dt,den_service_dt,den_process_dt);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_PK PRIMARY KEY (DEN_CLAIM_ID,DEN_CLAIM_LN_ID,COMMUNITY_ID,ADJ_TYP_CD,ADJ_SEQ_NO);

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_CARRIER_DIM_FK FOREIGN KEY (CARRIER_KEY) REFERENCES sartpappl_aetna_20181016_new.CARRIER_DIM (CARRIER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FACT_MEMBER_DIM_FK FOREIGN KEY (MEMBER_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DIM (MEMBER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_MEMBER_DEMOGRAPHIC_DIM_FK FOREIGN KEY (MEMBER_DEMOGRAPHIC_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DEMOGRAPHIC_DIM (MEMBER_DEMOGRAPHIC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_MEMBER_EMPLOYMENT_DIM_FK FOREIGN KEY (MEMBER_EMPLOYMENT_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_EMPLOYMENT_DIM (MEMBER_EMPLOYMENT_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_JOB_DIM_FK FOREIGN KEY (JOB_KEY) REFERENCES sartpappl_aetna_20181016_new.JOB_DIM (JOB_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_FAMILY_DIM_FK FOREIGN KEY (FAMILY_KEY) REFERENCES sartpappl_aetna_20181016_new.FAMILY_DIM (FAMILY_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_PLAN_DIM_FK FOREIGN KEY (PLAN_KEY) REFERENCES sartpappl_aetna_20181016_new.PLAN_DIM (PLAN_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_GROUP_DIM_FK FOREIGN KEY (GROUP_KEY) REFERENCES sartpappl_aetna_20181016_new.GROUP_DIM (GROUP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_CLAIM_TYP_DIM_FK FOREIGN KEY (CLAIM_TYP_KEY) REFERENCES sartpappl_aetna_20181016_new.CLAIM_TYP_DIM (CLAIM_TYP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_PROVIDER_DIM_FK FOREIGN KEY (SERVICING_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_PROVIDER_ADDRESS_DIM_FK FOREIGN KEY (SERVICING_PRVDR_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_PROVIDER_DIM_FK1 FOREIGN KEY (BILLING_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_PROVIDER_ADDRESS_DIM_FK1 FOREIGN KEY (BILLING_PRVDR_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_CLAIM_NETWORK_DIM_FK FOREIGN KEY (CLAIM_NETWORK_KEY) REFERENCES sartpappl_aetna_20181016_new.CLAIM_NETWORK_DIM (CLAIM_NETWORK_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_CLAIM_PROC_DIM_FK FOREIGN KEY (CLAIM_PROC_KEY) REFERENCES sartpappl_aetna_20181016_new.CLAIM_PROC_DIM (CLAIM_PROC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_STOPLOSS_DIM_FK FOREIGN KEY (STOPLOSS_KEY) REFERENCES sartpappl_aetna_20181016_new.STOPLOSS_DIM (STOPLOSS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_DENTAL_DIM_FK FOREIGN KEY (DEN_KEY) REFERENCES sartpappl_aetna_20181016_new.DENTAL_DIM (DEN_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_DENTAL_CLAIM_INFO_DIM_FK FOREIGN KEY (DEN_CLAIM_INFO_KEY) REFERENCES sartpappl_aetna_20181016_new.DENTAL_CLAIM_INFO_DIM (DEN_CLAIM_INFO_KEY);

COMMIT;

----------------------------------------------------------------------------------------------
--------                                                                                   CM HPD & ELIGIBILITY_INDICATOR
----------------------------------------------------------------------------------------------
CREATE TABLE sartpappl_aetna_20181016_new.HEALTH_PROFILE_DISEASE_DIM
(
  HPD_DISEASE_KEY   VARCHAR(32) NOT NULL ENCODE RAW,
  AFF_IND           BOOLEAN NULL ENCODE RAW,
  ADD_IND           BOOLEAN NULL ENCODE RAW,
  AID_IND           BOOLEAN NULL ENCODE RAW,
  ALC_IND           BOOLEAN NULL ENCODE RAW,
  ALG_IND           BOOLEAN NULL ENCODE RAW,
  ANX_IND           BOOLEAN NULL ENCODE RAW,
  AST_IND           BOOLEAN NULL ENCODE RAW,
  AUT_IND           BOOLEAN NULL ENCODE RAW,
  BIP_IND           BOOLEAN NULL ENCODE RAW,
  BLC_IND           BOOLEAN NULL ENCODE RAW,
  BNC_IND           BOOLEAN NULL ENCODE RAW,
  BPH_IND           BOOLEAN NULL ENCODE RAW,
  BRC_IND           BOOLEAN NULL ENCODE RAW,
  CAN_IND           BOOLEAN NULL ENCODE RAW,
  CAT_IND           BOOLEAN NULL ENCODE RAW,
  CBD_IND           BOOLEAN NULL ENCODE RAW,
  CDO_IND           BOOLEAN NULL ENCODE RAW,
  CFS_IND           BOOLEAN NULL ENCODE RAW,
  CHD_IND           BOOLEAN NULL ENCODE RAW,
  CHF_IND           BOOLEAN NULL ENCODE RAW,
  CHO_IND           BOOLEAN NULL ENCODE RAW,
  COC_IND           BOOLEAN NULL ENCODE RAW,
  COP_IND           BOOLEAN NULL ENCODE RAW,
  CRF_IND           BOOLEAN NULL ENCODE RAW,
  CRO_IND           BOOLEAN NULL ENCODE RAW,
  CTD_IND           BOOLEAN NULL ENCODE RAW,
  CVC_IND           BOOLEAN NULL ENCODE RAW,
  CYS_IND           BOOLEAN NULL ENCODE RAW,
  DEM_IND           BOOLEAN NULL ENCODE RAW,
  DEP_IND           BOOLEAN NULL ENCODE RAW,
  DIA_IND           BOOLEAN NULL ENCODE RAW,
  DNS_IND           BOOLEAN NULL ENCODE RAW,
  DTD_IND           BOOLEAN NULL ENCODE RAW,
  EDO_IND           BOOLEAN NULL ENCODE RAW,
  EDT_IND           BOOLEAN NULL ENCODE RAW,
  ENC_IND           BOOLEAN NULL ENCODE RAW,
  EPL_IND           BOOLEAN NULL ENCODE RAW,
  ESC_IND           BOOLEAN NULL ENCODE RAW,
  FIB_IND           BOOLEAN NULL ENCODE RAW,
  FIF_IND           BOOLEAN NULL ENCODE RAW,
  GLC_IND           BOOLEAN NULL ENCODE RAW,
  HCG_IND           BOOLEAN NULL ENCODE RAW,
  HDL_IND           BOOLEAN NULL ENCODE RAW,
  HEM_IND           BOOLEAN NULL ENCODE RAW,
  HEP_IND           BOOLEAN NULL ENCODE RAW,
  HNC_IND           BOOLEAN NULL ENCODE RAW,
  HYC_IND           BOOLEAN NULL ENCODE RAW,
  HYP_IND           BOOLEAN NULL ENCODE RAW,
  IDA_IND           BOOLEAN NULL ENCODE RAW,
  IHD_IND           BOOLEAN NULL ENCODE RAW,
  KST_IND           BOOLEAN NULL ENCODE RAW,
  LBP_IND           BOOLEAN NULL ENCODE RAW,
  LBW_IND           BOOLEAN NULL ENCODE RAW,
  LEU_IND           BOOLEAN NULL ENCODE RAW,
  LUC_IND           BOOLEAN NULL ENCODE RAW,
  LVB_IND           BOOLEAN NULL ENCODE RAW,
  LYM_IND           BOOLEAN NULL ENCODE RAW,
  MLM_IND           BOOLEAN NULL ENCODE RAW,
  MNP_IND           BOOLEAN NULL ENCODE RAW,
  MOH_IND           BOOLEAN NULL ENCODE RAW,
  MSS_IND           BOOLEAN NULL ENCODE RAW,
  MSX_IND           BOOLEAN NULL ENCODE RAW,
  NEU_IND           BOOLEAN NULL ENCODE RAW,
  NGD_IND           BOOLEAN NULL ENCODE RAW,
  OBE_IND           BOOLEAN NULL ENCODE RAW,
  OMD_IND           BOOLEAN NULL ENCODE RAW,
  ORC_IND           BOOLEAN NULL ENCODE RAW,
  OSP_IND           BOOLEAN NULL ENCODE RAW,
  OST_IND           BOOLEAN NULL ENCODE RAW,
  OVC_IND           BOOLEAN NULL ENCODE RAW,
  PAN_IND           BOOLEAN NULL ENCODE RAW,
  PAR_IND           BOOLEAN NULL ENCODE RAW,
  PER_IND           BOOLEAN NULL ENCODE RAW,
  PMC_IND           BOOLEAN NULL ENCODE RAW,
  PNC_IND           BOOLEAN NULL ENCODE RAW,
  PPD_IND           BOOLEAN NULL ENCODE RAW,
  PRC_IND           BOOLEAN NULL ENCODE RAW,
  PSY_IND           BOOLEAN NULL ENCODE RAW,
  PUD_IND           BOOLEAN NULL ENCODE RAW,
  PVD_IND           BOOLEAN NULL ENCODE RAW,
  RHA_IND           BOOLEAN NULL ENCODE RAW,
  SCA_IND           BOOLEAN NULL ENCODE RAW,
  SDO_IND           BOOLEAN NULL ENCODE RAW,
  SKC_IND           BOOLEAN NULL ENCODE RAW,
  SLE_IND           BOOLEAN NULL ENCODE RAW,
  STC_IND           BOOLEAN NULL ENCODE RAW,
  VNA_IND           BOOLEAN NULL ENCODE RAW,
  LOAD_DT_TIME      TIMESTAMP ENCODE ZSTD
)
SORTKEY (HPD_DISEASE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.HEALTH_PROFILE_DISEASE_DIM ADD CONSTRAINT HEALTH_PROFILE_DISEASE_DIM_PK PRIMARY KEY (HPD_DISEASE_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.ELIGIBILITY_INDICATOR_DIM
(
  ITC_IND                     BOOLEAN NULL ENCODE RAW,
  AHC_DM_IND                  BOOLEAN NULL ENCODE RAW,
  AETNA_INTL_CM_IND           BOOLEAN NULL ENCODE RAW,
  ALCOHOL_DM_IND              BOOLEAN NULL ENCODE RAW,
  ANXIETY_DM_IND              BOOLEAN NULL ENCODE RAW,
  ASTHMA_DM_IND               BOOLEAN NULL ENCODE RAW,
  ELIGIBILITY_INDICATOR_KEY   VARCHAR(32) NOT NULL ENCODE RAW,
  MOMS_TO_BABIES_IND          BOOLEAN NULL ENCODE RAW,
  BH_CNDTN_MGMT_IND           BOOLEAN NULL ENCODE RAW,
  CASE_MGMT_IND               BOOLEAN NULL ENCODE RAW,
  CAD_DM_IND                  BOOLEAN NULL ENCODE RAW,
  CHF_DM_IND                  BOOLEAN NULL ENCODE RAW,
  CKD_DM_IND                  BOOLEAN NULL ENCODE RAW,
  DEPRESSION_DM_IND           BOOLEAN NULL ENCODE RAW,
  DIABETES_DM_IND             BOOLEAN NULL ENCODE RAW,
  SSHL_IND                    BOOLEAN NULL ENCODE RAW,
  HBH_WEIGHT_50_IND           BOOLEAN NULL ENCODE RAW,
  HBH_WEIGHT_IND              BOOLEAN NULL ENCODE RAW,
  HLC_IND                     BOOLEAN NULL ENCODE RAW,
  INFERTILITY_IND             BOOLEAN NULL ENCODE RAW,
  INFORMED_HLTH_IND           BOOLEAN NULL ENCODE RAW,
  IHL_BOOKLET_IND             BOOLEAN NULL ENCODE RAW,
  IHL_INTL_LTR_IND            BOOLEAN NULL ENCODE RAW,
  IHL_POSTCARD_IND            BOOLEAN NULL ENCODE RAW,
  IMPCT_CR_PLUS_IND           BOOLEAN NULL ENCODE RAW,
  INTENSIVE_CM_IND            BOOLEAN NULL ENCODE RAW,
  LOW_BACK_DM_IND             BOOLEAN NULL ENCODE RAW,
  MEDICAL_IND                 BOOLEAN NULL ENCODE RAW,
  MED_PSYCH_CM_IND            BOOLEAN NULL ENCODE RAW,
  MHE_IND                     BOOLEAN NULL ENCODE RAW,
  MHEP_IND                    BOOLEAN NULL ENCODE RAW,
  NME_IND                     BOOLEAN NULL ENCODE RAW,
  PATIENT_MGMT_IND            BOOLEAN NULL ENCODE RAW,
  PHR_IND                     BOOLEAN NULL ENCODE RAW,
  SMART_CALL_IND              BOOLEAN NULL ENCODE RAW,
  WELLNESS_MGT_IND            BOOLEAN NULL ENCODE RAW,
  LOAD_DT_TIME                TIMESTAMP NULL ENCODE RAW
)
DISTSTYLE ALL SORTKEY (ELIGIBILITY_INDICATOR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ELIGIBILITY_INDICATOR_DIM ADD CONSTRAINT eligibility_ind_dim_pk PRIMARY KEY (ELIGIBILITY_INDICATOR_KEY);

-----------------------------------------------------------------------------
--------                                                                                                   ETG
-----------------------------------------------------------------------------
CREATE TABLE IF NOT EXISTS sartpappl_aetna_20181016_new.EPISODE_DIM
(
  EPISODE_KEY    VARCHAR(32) NOT NULL ENCODE RAW,
  EPSD_ID        BIGINT NOT NULL ENCODE raw,
  LOAD_DT_TIME   TIMESTAMP ENCODE ZSTD
)
SORTKEY (EPISODE_KEY,EPSD_ID);

ALTER TABLE sartpappl_aetna_20181016_new.episode_dim ADD CONSTRAINT episode_dim_pk PRIMARY KEY (episode_key);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.ETG_CNDTN_DIM
(
  ETG_CNDTN_KEY            VARCHAR(32) NOT NULL ENCODE RAW,
  ETG_CD                   CHAR(9) NOT NULL ENCODE RAW,
  ETG_MPC_CD               CHAR(3) ENCODE ZSTD,
  ETG1_CNDTN_CD            CHAR(4) ENCODE ZSTD,
  ETG_CNDTN_LONG_DSC       VARCHAR(120) NULL ENCODE ZSTD,
  ETG_CNDTN_SHRT_DSC       VARCHAR(30) NULL ENCODE ZSTD,
  ETG2_BDY_LCTN_CD         CHAR(2) ENCODE ZSTD,
  ETG_BASE_CD              CHAR(6) ENCODE ZSTD,
  ETG_BS_CLS_LNG_DSC       VARCHAR(120) NULL ENCODE ZSTD,
  ETG_BS_CLS_SHT_DSC       VARCHAR(30) NULL ENCODE ZSTD,
  ETG_CHRNC_IND            CHAR(1) ENCODE ZSTD,
  ETG3_CMPLCN_CD           CHAR(1) ENCODE ZSTD,
  ETG4_CMRBDY_CD           CHAR(1) ENCODE ZSTD,
  ETG5_TRTMNT_CD           CHAR(1) ENCODE ZSTD,
  ETG_ADJUSTER_NBR         INT ENCODE ZSTD,
  ETG_FUL_LONG_DESC        VARCHAR(120) NULL ENCODE ZSTD,
  ETG_FUL_SHRT_DESC        VARCHAR(30) NULL ENCODE ZSTD,
  ETG_CLN_PRD_DAYS_NBR     SMALLINT ENCODE ZSTD,
  ETG_RX_AFTER_DAYS_NBR    SMALLINT ENCODE ZSTD,
  ETG_RX_BEFORE_DAYS_NBR   SMALLINT ENCODE ZSTD,
  LOAD_DT_TIME             TIMESTAMP ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (ETG_CNDTN_KEY,ETG_CD);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_CNDTN_DIM ADD CONSTRAINT ETG_CNDTN_DIM_PK PRIMARY KEY (ETG_CNDTN_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT
(
  COMMUNITY_ID                VARCHAR(10) NOT NULL ENCODE ZSTD,
  EPISODE_KEY                 VARCHAR(32) NOT NULL ENCODE TEXT255,
  ETG_CNDTN_KEY               VARCHAR(32) NOT NULL ENCODE TEXT255,
  CARRIER_KEY                 VARCHAR(32) NOT NULL ENCODE TEXT255,
  MEMBER_KEY                  VARCHAR(32) NOT NULL ENCODE TEXT255,
  MEMBER_DEMOGRAPHIC_KEY      VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_EMPLOYMENT_KEY       VARCHAR(32) NOT NULL ENCODE TEXT255,
  MEMBER_IND_KEY              VARCHAR(32) NOT NULL ENCODE TEXT255,
  MEMBER_CLINICAL_KEY         VARCHAR(32) NOT NULL ENCODE TEXT255,
  GROUP_KEY                   VARCHAR(32) NOT NULL ENCODE RAW,
  PLAN_KEY                    VARCHAR(32) NOT NULL ENCODE TEXT255,
  FAMILY_KEY                  VARCHAR(32) NOT NULL ENCODE TEXT255,
  JOB_KEY                     VARCHAR(32) NOT NULL ENCODE TEXT255,
  STOPLOSS_KEY                VARCHAR(32) NOT NULL ENCODE TEXT255,
  PRVDR_KEY                   VARCHAR(32) NOT NULL ENCODE TEXT255,
  PRVDR_ADDRESS_KEY           VARCHAR(32) NOT NULL ENCODE TEXT255,
  IMP_PRVDR_KEY               VARCHAR(32) NOT NULL ENCODE TEXT255,
  IMP_PRVDR_ADDRESS_KEY       VARCHAR(32) NOT NULL ENCODE TEXT255,
  START_DIAG_KEY              VARCHAR(32) NOT NULL ENCODE TEXT255,
  SHIFT_DIAG_KEY              VARCHAR(32) NOT NULL ENCODE TEXT255,
  SHIFT_PROC_KEY              VARCHAR(32) NOT NULL ENCODE TEXT255,
  SECNDRY_PRVDR_KEY           VARCHAR(32) NOT NULL ENCODE TEXT255,
  RESP_FACILITY_KEY           VARCHAR(32) NOT NULL ENCODE TEXT255,
  RESP_FACILITY_ADDRESS_KEY   VARCHAR(32) NOT NULL ENCODE TEXT255,
  CLAIM_TYP_KEY               VARCHAR(32) NOT NULL ENCODE TEXT255,
  EPSD_START_DT               DATE ENCODE RAW,
  EPSD_STOP_DT                DATE ENCODE RAW,
  EPSD_ID                     BIGINT NOT NULL ENCODE ZSTD,
  EPSD_FRST_CLM_LN_ID         BIGINT ENCODE ZSTD,
  EPSD_ELGBL_DAYS_NBR         SMALLINT ENCODE ZSTD,
  EPSD_DAYS_CNT               SMALLINT ENCODE ZSTD,
  EPSD_COST_STAT_CD           CHAR(1) ENCODE ZSTD,
  EPSD_CLM_SRC_CD             CHAR(1) ENCODE ZSTD,
  EPSD_RECORD_TYPE_CD         CHAR(1) ENCODE ZSTD,
  EPSD_TYPE_CD                CHAR(1) ENCODE ZSTD,
  EPSD_SVRTY_SCR_NBR          DECIMAL(10,4) ENCODE ZSTD,
  EPSD_SVRTY_LVL_CD           CHAR(1) ENCODE ZSTD,
  EPSD_SVRTYERRST_IND         CHAR(1) ENCODE ZSTD,
  EPSD_INPT_ANC_ALLW_AMT      DECIMAL(11,2) ENCODE ZSTD,
  EPSD_INPT_ANC_BILL_AMT      DECIMAL(11,2) ENCODE ZSTD,
  EPSD_INPT_ANC_PAID_AMT      DECIMAL(11,2) ENCODE ZSTD,
  EPSD_INPT_RB_ALLW_AMT       DECIMAL(11,2) ENCODE ZSTD,
  EPSD_INPT_RB_BILL_AMT       DECIMAL(11,2) ENCODE ZSTD,
  EPSD_INPT_RB_PAID_AMT       DECIMAL(11,2) ENCODE ZSTD,
  EPSD_MGT_ALLW_AMT           DECIMAL(11,2) ENCODE ZSTD,
  EPSD_MGT_BILL_AMT           DECIMAL(11,2) ENCODE ZSTD,
  EPSD_MGT_PAID_AMT           DECIMAL(11,2) ENCODE ZSTD,
  EPSD_MKT_AVG_ALLW_AMT       DECIMAL(11,2) ENCODE ZSTD,
  EPSD_MKT_AVG_PAID_AMT       DECIMAL(11,2) ENCODE ZSTD,
  EPSD_MKT_AVG_GEO_LVL_CD     CHAR(1) ENCODE ZSTD,
  EPSD_MKT_AVGAWOTLSTS_CD     CHAR(1) ENCODE ZSTD,
  EPSD_MKT_AVGPDOTLSTS_CD     CHAR(1) ENCODE ZSTD,
  EPSD_NAT_AVG_ALLW_AMT       DECIMAL(11,2) ENCODE ZSTD,
  EPSD_NAT_AVG_GEO_LVL_CD     CHAR(1) ENCODE ZSTD,
  EPSD_NAT_AVG_PAID_AMT       DECIMAL(11,2) ENCODE ZSTD,
  EPSD_NAT_AVGAWOTLSTS_CD     CHAR(1) ENCODE ZSTD,
  EPSD_NAT_AVGPDOTLSTS_CD     CHAR(1) ENCODE ZSTD,
  EPSD_NDC_IND                CHAR(1) ENCODE ZSTD,
  EPSD_NTWK_SRV_AREA_ID       CHAR(5) ENCODE ZSTD,
  EPSD_AEXCEL_IND             CHAR(1) ENCODE ZSTD,
  EPSD_OTL_STS_CD             CHAR(1) ENCODE ZSTD,
  EPSD_PRFL_INTGTN_LVL_CD     CHAR(2) ENCODE ZSTD,
  EPSD_PROD_CTG_CD            CHAR(2) ENCODE ZSTD,
  EPSD_OTPT_ANC_ALLW_AMT      DECIMAL(11,2) ENCODE ZSTD,
  EPSD_OTPT_ANC_BILL_AMT      DECIMAL(11,2) ENCODE ZSTD,
  EPSD_OTPT_ANC_PAID_AMT      DECIMAL(11,2) ENCODE ZSTD,
  EPSD_REG_AVG_ALLW_AMT       DECIMAL(11,2) ENCODE ZSTD,
  EPSD_REG_AVG_GEO_LVL_CD     CHAR(2) ENCODE ZSTD,
  EPSD_REG_AVG_PAID_AMT       DECIMAL(11,2) ENCODE ZSTD,
  EPSD_REG_AVGAWOTLSTS_CD     CHAR(1) ENCODE ZSTD,
  EPSD_REG_AVGPDOTLSTS_CD     CHAR(1) ENCODE ZSTD,
  EPSD_RX_ALLW_AMT            DECIMAL(11,2) ENCODE ZSTD,
  EPSD_RX_BILL_AMT            DECIMAL(11,2) ENCODE ZSTD,
  EPSD_RX_PAID_AMT            DECIMAL(11,2) ENCODE ZSTD,
  EPSD_SURG_ALLW_AMT          DECIMAL(11,2) ENCODE ZSTD,
  EPSD_SURG_BILL_AMT          DECIMAL(11,2) ENCODE ZSTD,
  EPSD_SURG_PAID_AMT          DECIMAL(11,2) ENCODE ZSTD,
  EPSD_TOTAL_ALLW_AMT         DECIMAL(11,2) ENCODE ZSTD,
  EPSD_TOTAL_BILL_AMT         DECIMAL(11,2) ENCODE ZSTD,
  EPSD_TOTAL_PAID_AMT         DECIMAL(11,2) ENCODE ZSTD,
  EPSD_TOTAL_RX_BILL_PD_AMT   DECIMAL(11,2) ENCODE ZSTD,
  EPSD_TOTAL_RX_PAY_PD_AMT    DECIMAL(11,2) ENCODE ZSTD,
  EPSD_TOTAL_CONF_CNT         SMALLINT ENCODE ZSTD,
  EPSD_TOTAL_CONF_DAY_CNT     SMALLINT ENCODE ZSTD,
  SRC_ID                      CHAR(2) ENCODE ZSTD,
  LOAD_DT_TIME                TIMESTAMP ENCODE ZSTD,
  MEMBER_ID_DEC               VARCHAR(25) NOT NULL ENCODE ZSTD,
  MEMBER_ID_ENC               VARCHAR(25) NOT NULL ENCODE ZSTD,
  MEMBER_CONSU_IQ_KEY         VARCHAR(32) NOT NULL ENCODE RAW,
  HPD_DISEASE_KEY             VARCHAR(32) NOT NULL ENCODE RAW,
  ELIGIBILITY_IND_KEY         VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_AGE                  SMALLINT ENCODE ZSTD,
  LOCAL_PLAN_MKT_CD           VARCHAR(6),
  SES_INDEX_LVL               NUMERIC(1,0)
)
DISTKEY (Member_Demographic_key) COMPOUND SORTKEY (epsd_start_dt,epsd_stop_dt);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_PK PRIMARY KEY (COMMUNITY_ID,EPISODE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_MEMBER_DIM_FK FOREIGN KEY (MEMBER_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DIM (MEMBER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_PROVIDER_DIM_FK FOREIGN KEY (IMP_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_GROUP_DIM_FK FOREIGN KEY (GROUP_KEY) REFERENCES sartpappl_aetna_20181016_new.GROUP_DIM (GROUP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_PROVIDER_DIM_FK1 FOREIGN KEY (PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_PLAN_DIM_FK FOREIGN KEY (PLAN_KEY) REFERENCES sartpappl_aetna_20181016_new.PLAN_DIM (PLAN_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_MEMBER_IND_DIM_FK FOREIGN KEY (MEMBER_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_IND_DIM (MEMBER_IND_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_MEMBER_EMPLOYMENT_DIM_FK FOREIGN KEY (MEMBER_EMPLOYMENT_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_EMPLOYMENT_DIM (MEMBER_EMPLOYMENT_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_MEMBER_DEMOGRAPHIC_DIM_FK FOREIGN KEY (MEMBER_DEMOGRAPHIC_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DEMOGRAPHIC_DIM (MEMBER_DEMOGRAPHIC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_STOPLOSS_DIM_FK FOREIGN KEY (STOPLOSS_KEY) REFERENCES sartpappl_aetna_20181016_new.STOPLOSS_DIM (STOPLOSS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_FAMILY_DIM_FK FOREIGN KEY (FAMILY_KEY) REFERENCES sartpappl_aetna_20181016_new.FAMILY_DIM (FAMILY_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_PROVIDER_ADDRESS_DIM_FK FOREIGN KEY (PRVDR_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_CARRIER_DIM_FK FOREIGN KEY (CARRIER_KEY) REFERENCES sartpappl_aetna_20181016_new.CARRIER_DIM (CARRIER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_PROVIDER_ADDRESS_DIM_FK1 FOREIGN KEY (IMP_PRVDR_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_MEMBER_CLINICAL_DIM_FK FOREIGN KEY (MEMBER_CLINICAL_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CLINICAL_DIM (MEMBER_CLINICAL_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_JOB_DIM_FK FOREIGN KEY (JOB_KEY) REFERENCES sartpappl_aetna_20181016_new.JOB_DIM (JOB_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_DIAG_DIM_FK FOREIGN KEY (START_DIAG_KEY) REFERENCES sartpappl_aetna_20181016_new.DIAG_DIM (DIAG_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_DIAG_DIM_FK1 FOREIGN KEY (SHIFT_DIAG_KEY) REFERENCES sartpappl_aetna_20181016_new.DIAG_DIM (DIAG_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_SURGICAL_PROC_DIM_FK FOREIGN KEY (SHIFT_PROC_KEY) REFERENCES sartpappl_aetna_20181016_new.SURGICAL_PROC_DIM (SURGICAL_PROC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_PROVIDER_DIM_FK2 FOREIGN KEY (RESP_FACILITY_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_PROVIDER_ADDRESS_DIM_FK2 FOREIGN KEY (RESP_FACILITY_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_PROVIDER_DIM_FK3 FOREIGN KEY (SECNDRY_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_CLAIM_TYP_DIM_FK FOREIGN KEY (CLAIM_TYP_KEY) REFERENCES sartpappl_aetna_20181016_new.CLAIM_TYP_DIM (CLAIM_TYP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_EPISODE_DIM_FK FOREIGN KEY (EPISODE_KEY) REFERENCES sartpappl_aetna_20181016_new.EPISODE_DIM (EPISODE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_ETG_CNDTN_DIM_FK FOREIGN KEY (ETG_CNDTN_KEY) REFERENCES sartpappl_aetna_20181016_new.ETG_CNDTN_DIM (ETG_CNDTN_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_HEALTH_PROFILE_DISEASE_DIM_FK FOREIGN KEY (HPD_DISEASE_KEY) REFERENCES sartpappl_aetna_20181016_new.HEALTH_PROFILE_DISEASE_DIM (HPD_DISEASE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_ELIGIBILITY_IND_DIM_FK FOREIGN KEY (ELIGIBILITY_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.ELIGIBILITY_INDICATOR_DIM (ELIGIBILITY_INDICATOR_KEY);

COMMIT;

---------------------------------------------------------------------
--------                                                                                   PREDICTIVE
----------------------------------------------------------------------
CREATE TABLE sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID           VARCHAR(10) NOT NULL ENCODE RAW,
  PREDICTIVE_SCORE_DESC   VARCHAR(25) NULL ENCODE ZSTD,
  THRESHHOLD_VALUE        NUMERIC(9,4) NULL ENCODE ZSTD,
  MEASURE_CMPNT_ID        VARCHAR(16) NULL ENCODE ZSTD,
  LOAD_DATE_TIME          DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (PREDICTIVE_ID);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PREDICTIVE_DIM ADD CONSTRAINT PREDICTIVE_DIM_AETHPK1019_PK PRIMARY KEY (PREDICTIVE_ID);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.MEMBER_PREDICTIVE_MODEL_FCT
(
  MEMBER_ID_DEC            VARCHAR(25) NOT NULL ENCODE ZSTD,
  COMMUNITY_ID             VARCHAR(10) NOT NULL ENCODE ZSTD,
  MEMBER_KEY               VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_DEMOGRAPHIC_KEY   VARCHAR(32) NOT NULL ENCODE RAW,
  PLAN_KEY                 VARCHAR(32) NOT NULL ENCODE RAW,
  GROUP_KEY                VARCHAR(32) NOT NULL ENCODE RAW,
  CARRIER_KEY              VARCHAR(32) NOT NULL ENCODE RAW,
  PREDICTIVE_ELIG_DT       DATE NOT NULL ENCODE RAW,
  PREDICTIVE_ID            VARCHAR(10) NOT NULL ENCODE ZSTD,
  ACTUAL_SCORE             NUMERIC(9,4) NULL ENCODE ZSTD,
  SRC_ID                   VARCHAR(2) NULL ENCODE ZSTD,
  LOAD_DATE_TIME           DATETIME NULL ENCODE ZSTD,
  MEMBER_ID_ENC            VARCHAR(25) NOT NULL ENCODE ZSTD,
  MEMBER_CONSU_IQ_KEY      VARCHAR(32) NOT NULL ENCODE RAW,
  HPD_DISEASE_KEY          VARCHAR(32) NOT NULL ENCODE RAW,
  ELIGIBILITY_IND_KEY      VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_AGE               SMALLINT ENCODE ZSTD,
  LOCAL_PLAN_MKT_CD        VARCHAR(6),
  SES_INDEX_LVL            NUMERIC(1,0)
)
DISTKEY (Member_Demographic_key) SORTKEY (predictive_elig_dt);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PREDICTIVE_MODEL_FCT ADD CONSTRAINT MEMBER_PREDICTIVE_MODEL_FCT_AETHPK1019_PK PRIMARY KEY (MEMBER_KEY,PREDICTIVE_ELIG_DT,COMMUNITY_ID,PLAN_KEY,PREDICTIVE_ID);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PREDICTIVE_MODEL_FCT ADD CONSTRAINT MEMBER_PREDICTIVE_MODEL_FCT_CARRIER_DIM_AETHPK1019_FK FOREIGN KEY (CARRIER_KEY) REFERENCES sartpappl_aetna_20181016_new.CARRIER_DIM (CARRIER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PREDICTIVE_MODEL_FCT ADD CONSTRAINT MEMBER_PREDICTIVE_MODEL_FCT_GROUP_DIM_AETHPK1019_FK FOREIGN KEY (GROUP_KEY) REFERENCES sartpappl_aetna_20181016_new.GROUP_DIM (GROUP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PREDICTIVE_MODEL_FCT ADD CONSTRAINT MEMBER_PREDICTIVE_MODEL_FCT_MEMBER_DEMOGRAPHIC_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_DEMOGRAPHIC_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DEMOGRAPHIC_DIM (MEMBER_DEMOGRAPHIC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PREDICTIVE_MODEL_FCT ADD CONSTRAINT MEMBER_PREDICTIVE_MODEL_FCT_MEMBER_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DIM (MEMBER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PREDICTIVE_MODEL_FCT ADD CONSTRAINT MEMBER_PREDICTIVE_MODEL_FCT_PLAN_DIM_AETHPK1019_FK FOREIGN KEY (PLAN_KEY) REFERENCES sartpappl_aetna_20181016_new.PLAN_DIM (PLAN_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PREDICTIVE_MODEL_FCT ADD CONSTRAINT MEMBER_PREDICTIVE_MODEL_FCT_PREDICTIVE_DIM_AETHPK1019_FK FOREIGN KEY (PREDICTIVE_ID) REFERENCES sartpappl_aetna_20181016_new.PREDICTIVE_DIM (PREDICTIVE_ID);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PREDICTIVE_MODEL_FCT ADD CONSTRAINT MEMBER_PREDICTIVE_MODEL_FCT_HEALTH_PROFILE_DISEASE_DIM_FK FOREIGN KEY (HPD_DISEASE_KEY) REFERENCES sartpappl_aetna_20181016_new.HEALTH_PROFILE_DISEASE_DIM (HPD_DISEASE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PREDICTIVE_MODEL_FCT ADD CONSTRAINT MEMBER_PREDICTIVE_MODEL_FCT_ELIGIBILITY_IND_DIM_FK FOREIGN KEY (ELIGIBILITY_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.ELIGIBILITY_INDICATOR_DIM (ELIGIBILITY_INDICATOR_KEY);

COMMIT;

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1002,
  'AITC_PULSE',
  0,
  10004,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1003,
  'AITC_AOS_SCORE',
  0,
  10006,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1004,
  'AITC_INPATIENT_PREDICTION',
  0,
  10008,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1005,
  'DISABILITY_SCORE',
  0,
  10209,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1006,
  'RISK_IP_NEXT_1TO3_MONTHS',
  0,
  20411,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1007,
  'RISK_IP_NEXT_1TO6_MONTHS',
  0,
  20412,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1008,
  'RISK_IP_NEXT_4TO9_MONTHS',
  0,
  20413,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1009,
  'RISK_IP_NEXT_1TO9_MONTHS',
  0,
  20414,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1010,
  'RISK_IP_NEXT_4TO12_MONTHS',
  0,
  20415,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1011,
  'RISK_IP_NEXT_1TO12_MONTHS',
  0,
  20416,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1012,
  'RISK_ER_NEXT_6_MONTHS',
  0,
  60069999000001,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1013,
  'CMOS_SCORE',
  0,
  60069999000002,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1014,
  'INPATIENT_SEVERITY_INDEX',
  0,
  0,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1015,
  'HEALTH_ASSESSMENT_RISK',
  0,
  0,
  CURRENT_TIMESTAMP
);

INSERT INTO sartpappl_aetna_20181016_new.PREDICTIVE_DIM
(
  PREDICTIVE_ID,
  PREDICTIVE_SCORE_DESC,
  THRESHHOLD_VALUE,
  MEASURE_CMPNT_ID,
  LOAD_DATE_TIME
)
VALUES
(
  1001,
  'PULSE',
  0,
  0,
  CURRENT_TIMESTAMP
);

COMMIT;

--VACUUM sartpappl_aetna_20181016_new.PREDICTIVE_DIM;
--ANALYZE sartpappl_aetna_20181016_new.PREDICTIVE_DIM;
--------------------------------------------------------------------
--------                                                                                                   VISION
--------------------------------------------------------------------
CREATE TABLE sartpappl_aetna_20181016_new.VIS_PROC_DIM
(
  VIS_PROC_KEY   VARCHAR(32) NOT NULL ENCODE RAW,
  PROC_TYP_CD    VARCHAR(1) NULL ENCODE RAW,
  PROC_CD        VARCHAR(7) NULL ENCODE RAW,
  PROC_GRP_CD    VARCHAR(3) NULL ENCODE ZSTD,
  LOAD_DT_TIME   DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (VIS_PROC_KEY,PROC_TYP_CD,PROC_CD);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_PROC_DIM ADD CONSTRAINT VIS_PROC_DIM_AETHDE_PK1019_PK PRIMARY KEY (VIS_PROC_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.VIS_CLAIM_INFO_DIM
(
  VIS_CLAIM_INFO_KEY   VARCHAR(32) NOT NULL ENCODE RAW,
  STOP_LOSS_IND        VARCHAR(2) NULL ENCODE ZSTD,
  STOP_LOSS_CTGY_CD    VARCHAR(1) NULL ENCODE ZSTD,
  LOAD_DT_TIME         DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (VIS_CLAIM_INFO_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIM_INFO_DIM ADD CONSTRAINT VIS_CLAIM_INFO_DIM_AETHDE_PK1019_PK PRIMARY KEY (VIS_CLAIM_INFO_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT
(
  VIS_CLAIM_ID                  VARCHAR(25) NOT NULL ENCODE ZSTD,
  VIS_CLAIM_LN_ID               VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID                  VARCHAR(10) NOT NULL ENCODE ZSTD,
  ADJ_TYP_CD                    VARCHAR(1) NOT NULL ENCODE ZSTD,
  ADJ_SEQ_NO                    INTEGER NOT NULL ENCODE ZSTD,
  MEMBER_ID_DEC                 VARCHAR(25) NOT NULL ENCODE ZSTD,
  CARRIER_KEY                   VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_KEY                    VARCHAR(32) NOT NULL ENCODE RAW,
  PLAN_KEY                      VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_DEMOGRAPHIC_KEY        VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_EMPLOYMENT_KEY         VARCHAR(32) NOT NULL ENCODE RAW,
  JOB_KEY                       VARCHAR(32) NOT NULL ENCODE RAW,
  FAMILY_KEY                    VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_CLINICAL_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_IND_KEY                VARCHAR(32) NOT NULL ENCODE RAW,
  GROUP_KEY                     VARCHAR(32) NOT NULL ENCODE RAW,
  SERVICING_PRVDR_KEY           VARCHAR(32) NOT NULL ENCODE RAW,
  SERVICING_PRVDR_ADDRESS_KEY   VARCHAR(32) NOT NULL ENCODE RAW,
  BILLING_PRVDR_KEY             VARCHAR(32) NOT NULL ENCODE RAW,
  BILLING_PRVDR_ADDRESS_KEY     VARCHAR(32) NOT NULL ENCODE RAW,
  SERVICE_TYP_KEY               VARCHAR(32) NOT NULL ENCODE RAW,
  CLAIM_NETWORK_KEY             VARCHAR(32) NOT NULL ENCODE RAW,
  CLAIM_TYP_KEY                 VARCHAR(32) NOT NULL ENCODE RAW,
  STOPLOSS_KEY                  VARCHAR(32) NOT NULL ENCODE RAW,
  VIS_PROC_KEY                  VARCHAR(32) NOT NULL ENCODE RAW,
  VIS_CLAIM_INFO_KEY            VARCHAR(32) NOT NULL ENCODE RAW,
  ELIG_TAG_FLG_CD               VARCHAR(1) NULL ENCODE ZSTD,
  VIS_SERVICE_START_DT          DATE NULL ENCODE RAW,
  VIS_SERVICE_END_DT            DATE NULL ENCODE ZSTD,
  VIS_PROCESS_DT                DATE NULL ENCODE RAW,
  VIS_PAID_DT                   DATE NULL ENCODE RAW,
  VIS_UNITS_CNT                 INTEGER NULL ENCODE ZSTD,
  VIS_BILLED_AMT                NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_NOT_COVERED_AMT           NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_ALLOWED_AMT               NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_DISCOUNT_AMT              NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_PENALTY_AMT               NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_DEDUCTIBLE_AMT            NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_COPAY_AMT                 NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_COINSURANCE_AMT           NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_COB_AMT                   NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_PAID_AMT                  NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_PLAN_LIABILITY_AMT        NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_HSA_AMT                   NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_HRA_AMT                   NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_STOP_LOSS_AMT             NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_WITHHOLD_AMT              NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_WITHHOLD_CD               VARCHAR(2) NULL ENCODE ZSTD,
  VIS_ACCESS_FEE                NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_SUBROGATION_AMT           NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_SAVINGS_AMT               NUMERIC(9,2) NULL ENCODE ZSTD,
  VIS_SERVICES_CNT              INTEGER NULL ENCODE ZSTD,
  VIS_CNT                       INTEGER NULL ENCODE ZSTD,
  VIS_CLAIMANTS                 INTEGER NULL ENCODE ZSTD,
  VIS_OOP_AMT                   NUMERIC(9,2) NULL ENCODE ZSTD,
  SRC_ID                        VARCHAR(2) NULL ENCODE ZSTD,
  LOAD_DT_TIME                  DATE NULL ENCODE ZSTD,
  MEMBER_ID_ENC                 VARCHAR(25) NOT NULL ENCODE ZSTD,
  MEMBER_CONSU_IQ_KEY           VARCHAR(32) NOT NULL ENCODE ZSTD,
  HPD_DISEASE_KEY               VARCHAR(32) NOT NULL ENCODE ZSTD,
  ELIGIBILITY_IND_KEY           VARCHAR(32) NOT NULL ENCODE ZSTD,
  MEMBER_AGE                    SMALLINT NULL ENCODE ZSTD,
  LOCAL_PLAN_MKT_CD             VARCHAR(6),
  SES_INDEX_LVL                 NUMERIC(1,0)
)
DISTKEY (Member_Demographic_key) INTERLEAVED SORTKEY (vis_paid_dt,vis_service_start_dt,vis_process_dt);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_AETHPK1019_PK PRIMARY KEY (VIS_CLAIM_ID,VIS_CLAIM_LN_ID,ADJ_TYP_CD,ADJ_SEQ_NO,COMMUNITY_ID);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_CARRIER_DIM_AETHPK1019_FK FOREIGN KEY (CARRIER_KEY) REFERENCES sartpappl_aetna_20181016_new.CARRIER_DIM (CARRIER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_CLAIM_NETWORK_DIM_AETHPK1019_FK FOREIGN KEY (CLAIM_NETWORK_KEY) REFERENCES sartpappl_aetna_20181016_new.CLAIM_NETWORK_DIM (CLAIM_NETWORK_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_CLAIM_TYP_DIM_AETHPK1019_FK FOREIGN KEY (CLAIM_TYP_KEY) REFERENCES sartpappl_aetna_20181016_new.CLAIM_TYP_DIM (CLAIM_TYP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_FAMILY_DIM_AETHPK1019_FK FOREIGN KEY (FAMILY_KEY) REFERENCES sartpappl_aetna_20181016_new.FAMILY_DIM (FAMILY_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_GROUP_DIM_AETHPK1019_FK FOREIGN KEY (GROUP_KEY) REFERENCES sartpappl_aetna_20181016_new.GROUP_DIM (GROUP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_JOB_DIM_AETHPK1019_FK FOREIGN KEY (JOB_KEY) REFERENCES sartpappl_aetna_20181016_new.JOB_DIM (JOB_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_MEMBER_DEMOGRAPHIC_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_DEMOGRAPHIC_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DEMOGRAPHIC_DIM (MEMBER_DEMOGRAPHIC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_MEMBER_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DIM (MEMBER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_MEMBER_EMPLOYMENT_DIM_AETHPK1019_FK FOREIGN KEY (MEMBER_EMPLOYMENT_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_EMPLOYMENT_DIM (MEMBER_EMPLOYMENT_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_PLAN_DIM_AETHPK1019_FK FOREIGN KEY (PLAN_KEY) REFERENCES sartpappl_aetna_20181016_new.PLAN_DIM (PLAN_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_PROVIDER_ADDRESS_DIM_AETHPK1019_FK FOREIGN KEY (SERVICING_PRVDR_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_PROVIDER_ADDRESS_DIM_AETHPK1019_FK1 FOREIGN KEY (BILLING_PRVDR_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_PROVIDER_DIM_AETHPK1019_FK FOREIGN KEY (SERVICING_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_PROVIDER_DIM_AETHPK1019_FK1 FOREIGN KEY (BILLING_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_SERVICE_TYPE_DIM_AETHPK1019_FK FOREIGN KEY (SERVICE_TYP_KEY) REFERENCES sartpappl_aetna_20181016_new.SERVICE_TYPE_DIM (SERVICE_TYP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_STOPLOSS_DIM_AETHPK1019_FK FOREIGN KEY (STOPLOSS_KEY) REFERENCES sartpappl_aetna_20181016_new.STOPLOSS_DIM (STOPLOSS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_VIS_CLAIM_INFO_DIM_AETHPK1019_FK FOREIGN KEY (VIS_CLAIM_INFO_KEY) REFERENCES sartpappl_aetna_20181016_new.VIS_CLAIM_INFO_DIM (VIS_CLAIM_INFO_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_VIS_PROC_DIM_AETHPK1019_FK FOREIGN KEY (VIS_PROC_KEY) REFERENCES sartpappl_aetna_20181016_new.VIS_PROC_DIM (VIS_PROC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_HEALTH_PROFILE_DISEASE_DIM_FK FOREIGN KEY (HPD_DISEASE_KEY) REFERENCES sartpappl_aetna_20181016_new.HEALTH_PROFILE_DISEASE_DIM (HPD_DISEASE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_ELIGIBILITY_IND_DIM_FK FOREIGN KEY (ELIGIBILITY_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.ELIGIBILITY_INDICATOR_DIM (ELIGIBILITY_INDICATOR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_MEMBER_IND_DIM_FK FOREIGN KEY (MEMBER_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_IND_DIM (MEMBER_IND_KEY);

COMMIT;

-----------------------------------------------------------------------------
--------                                                                                                                   ADMISSION
-----------------------------------------------------------------------------
CREATE TABLE sartpappl_aetna_20181016_new.ADMISSION_CLINICAL_DIM
(
  ADM_CLINICAL_KEY               VARCHAR(32) NOT NULL ENCODE RAW,
  ADM_SERVICE_TYP_CD             VARCHAR(1) NULL ENCODE ZSTD,
  ADM_CMS_CLINICAL_COHART        VARCHAR(40) NULL ENCODE ZSTD,
  ADM_CMS_CLINICAL_CTGY          VARCHAR(40) NULL ENCODE ZSTD,
  PQI_CD                         VARCHAR(35) NULL ENCODE ZSTD,
  DISCRETIONARY_IND              VARCHAR(1) NULL ENCODE ZSTD,
  ADM_SUPPLY_SENSITIVE_PROC_CD   VARCHAR(2) NULL ENCODE ZSTD,
  ADM_DISCHARGE_STATUS_CD        VARCHAR(2) NULL ENCODE ZSTD,
  ADM_TYP_CD                     VARCHAR(2) NULL ENCODE ZSTD,
  ADM_SOURCE_CD                  VARCHAR(2) NULL ENCODE ZSTD,
  ADM_POS_CTGY_CD                VARCHAR(1) NULL ENCODE RAW,
  ADM_CMS_INDEX_FLG              VARCHAR(1) NULL ENCODE ZSTD,
  LOAD_DT_TIME                   DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL INTERLEAVED SORTKEY (ADM_CLINICAL_KEY,ADM_POS_CTGY_CD);

-- -- ADMISSION_CLINICAL_DIM
COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_CLINICAL_DIM ADD CONSTRAINT ADMISSION_CLINICAL_DIM_PK PRIMARY KEY (ADM_CLINICAL_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.DRG_GROUPER_DIM
(
  DRG_GROUPER_KEY               VARCHAR(32) NOT NULL ENCODE RAW,
  INITIAL_DRG_CD                VARCHAR(4) NULL ENCODE ZSTD,
  MS_DRG_CD                     VARCHAR(4) NULL ENCODE RAW,
  APR_DRG_CD                    VARCHAR(3) NULL ENCODE ZSTD,
  HOSPITAL_ACQD_CONDITION       VARCHAR(1) NULL ENCODE ZSTD,
  APR_DRG_TYP_CD                VARCHAR(1) NULL ENCODE ZSTD,
  MS_DRG_TYP_CD                 VARCHAR(1) NULL ENCODE ZSTD,
  APR_MDC_CD                    VARCHAR(2) NULL ENCODE ZSTD,
  APR_SERVICE_CTGY_CD           NUMERIC(3,0) ENCODE ZSTD,
  MS_MDC_CD                     VARCHAR(2) NULL ENCODE RAW,
  POTENTIALLY_PREVENTABLE_ADM   VARCHAR(1) NULL ENCODE ZSTD,
  LOAD_DATE_TIME                DATETIME NULL ENCODE ZSTD,
  MS_DG_CD                      VARCHAR(5) NULL ENCODE ZSTD
)
DISTSTYLE ALL INTERLEAVED SORTKEY (DRG_GROUPER_KEY,MS_DRG_CD,MS_MDC_CD);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DRG_GROUPER_DIM ADD CONSTRAINT DRG_GROUPER_DIM_PK PRIMARY KEY (DRG_GROUPER_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.READMISSIONS_DIM
(
  ADMISSIONS_KEY        VARCHAR(32) NOT NULL ENCODE RAW,
  RADM_ORIGINAL_IND     VARCHAR(1) NULL ENCODE ZSTD,
  RADM_INTERVAL         VARCHAR(5) NULL ENCODE ZSTD,
  SAME_ACUTE_HOSP_IND   VARCHAR(1) NULL ENCODE ZSTD,
  CMS_RADM_FLG          VARCHAR(1) NULL ENCODE ZSTD,
  SAME_DRG_IND          VARCHAR(1) NULL ENCODE ZSTD,
  LOAD_DT_TIME          DATETIME NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (ADMISSIONS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.READMISSIONS_DIM ADD CONSTRAINT READMISSIONS_DIM_PK PRIMARY KEY (ADMISSIONS_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.PROC_DIM
(
  PROC_KEY                       VARCHAR(32) NOT NULL ENCODE ZSTD,
  PROC_CD                        VARCHAR(7) NULL ENCODE ZSTD,
  PROC_CD_DESC                   VARCHAR(150) NULL ENCODE ZSTD,
  PROC_CLASS_CD                  VARCHAR(1) NULL ENCODE ZSTD,
  PROC_CLASS_DESC                VARCHAR(150) NULL ENCODE ZSTD,
  PROC_CTGY_CD                   VARCHAR(4) NULL ENCODE ZSTD,
  PROC_CTGY_DESC                 VARCHAR(150) NULL ENCODE ZSTD,
  PROC_GRP_CD                    VARCHAR(3) NULL ENCODE ZSTD,
  PROC_GRP_DESC                  VARCHAR(150) NULL ENCODE ZSTD,
  PQI_CD                         VARCHAR(35) NULL ENCODE ZSTD,
  ADM_SUPPLY_SENSITIVE_PROC_CD   VARCHAR(2) NULL ENCODE ZSTD,
  PREFERENCE_SENSITIVE_PROC_CD   VARCHAR(2) NULL ENCODE ZSTD,
  LOAD_DT_TIME                   TIMESTAMP NULL ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (PROC_KEY,PROC_CD,PROC_CTGY_CD,PROC_GRP_CD);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PROC_DIM ADD CONSTRAINT PROC_DIM_AETHPK1019_PK PRIMARY KEY (PROC_KEY);

COMMIT;

CREATE TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT
(
  ADM_ID                              VARCHAR(20) NOT NULL ENCODE ZSTD,
  CARRIER_KEY                         VARCHAR(32) NOT NULL ENCODE RAW,
  COMMUNITY_ID                        VARCHAR(10) NULL ENCODE ZSTD,
  CMS_INDEX_ADM_ID                    DECIMAL(10,0) ENCODE ZSTD,
  MEMBER_KEY                          VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_ID_DEC                       VARCHAR(25) NULL ENCODE ZSTD,
  MEMBER_DEMOGRAPHIC_KEY              VARCHAR(32) NOT NULL ENCODE RAW,
  PLAN_KEY                            VARCHAR(32) NOT NULL ENCODE ZSTD,
  GROUP_KEY                           VARCHAR(32) NOT NULL ENCODE RAW,
  FACILITY_PRVDR_KEY                  VARCHAR(32) NOT NULL ENCODE ZSTD,
  PRIMARY_PRVDR_KEY                   VARCHAR(32) NOT NULL ENCODE ZSTD,
  FACILITY_PRVDR_ADDRESS_KEY          VARCHAR(32) NOT NULL ENCODE ZSTD,
  PRIMARY_PRVDR_ADDRESS_KEY           VARCHAR(32) NOT NULL ENCODE ZSTD,
  BILLING_PRVDR_KEY                   VARCHAR(32) NOT NULL ENCODE ZSTD,
  BILLING_PRVDR_ADDRESS_KEY           VARCHAR(32) NOT NULL ENCODE ZSTD,
  REFERRING_PRVDR_KEY                 VARCHAR(32) NOT NULL ENCODE ZSTD,
  ADMISSION_CLINICAL_KEY              VARCHAR(32) NOT NULL ENCODE ZSTD,
  ADMISSIONS_KEY                      VARCHAR(32) NOT NULL ENCODE ZSTD,
  DRG_GROUPER_KEY                     VARCHAR(32) NOT NULL ENCODE ZSTD,
  MEMBER_EMPLOYMENT_KEY               VARCHAR(32) NOT NULL ENCODE ZSTD,
  JOB_KEY                             VARCHAR(32) NOT NULL ENCODE ZSTD,
  FAMILY_KEY                          VARCHAR(32) NOT NULL ENCODE ZSTD,
  MEMBER_CLINICAL_KEY                 VARCHAR(32) NOT NULL ENCODE ZSTD,
  MEMBER_IND_KEY                      VARCHAR(32) NOT NULL ENCODE ZSTD,
  CLAIM_NETWORK_KEY                   VARCHAR(32) NOT NULL ENCODE ZSTD,
  ADMIT_DT                            DATE NULL ENCODE RAW,
  ADM_CMS_INDEX_DT                    DATE NULL ENCODE ZSTD,
  ADM_DISCHARGE_DT                    DATE NULL ENCODE RAW,
  ADM_PAID_DT                         DATE NULL ENCODE RAW,
  ADM_DAYS                            DECIMAL(5,2) ENCODE ZSTD,
  ADM_PROFESSIONAL_ALLOWED_AMT        DECIMAL(11,0) ENCODE ZSTD,
  ADM_PRIMARY_PHYSICIAN_ALLOWED_AMT   DECIMAL(11,0) ENCODE ZSTD,
  ADM_PRIMARY_PHYSICIAN_BILLED_AMT    DECIMAL(11,0) ENCODE ZSTD,
  ADM_PRIMARY_PHYSICIAN_PAID_AMT      DECIMAL(11,0) ENCODE ZSTD,
  ADM_PROFESSIONAL_BILLED_AMT         DECIMAL(11,0) ENCODE ZSTD,
  ADM_PROFESSIONAL_PAID_AMT           DECIMAL(11,0) ENCODE ZSTD,
  ADM_COB_AMT                         DECIMAL(9,2) ENCODE ZSTD,
  ADM_BILLED_AMT                      DECIMAL(9,2) ENCODE ZSTD,
  ADM_COINSURANCE_AMT                 DECIMAL(9,2) ENCODE ZSTD,
  ADM_COPAYMENT_AMT                   DECIMAL(9,2) ENCODE ZSTD,
  ADM_DEDUCTIBLE_AMT                  DECIMAL(9,2) ENCODE ZSTD,
  ADM_DISCOUNT_AMT                    DECIMAL(9,2) ENCODE ZSTD,
  ADM_ALLOWED_AMT                     DECIMAL(9,2) ENCODE ZSTD,
  ADM_FACILITY_ALLOWED_AMT            DECIMAL(11,0) ENCODE ZSTD,
  ADM_FACILITY_BILLED_AMT             DECIMAL(11,0) ENCODE ZSTD,
  ADM_FACILITY_PAID_AMT               DECIMAL(11,0) ENCODE ZSTD,
  ADM_PAID_AMT                        DECIMAL(9,2) ENCODE ZSTD,
  ADM_PAID_LIABILITY_AMT              DECIMAL(9,2) ENCODE ZSTD,
  ADM_PENALTY_AMT                     DECIMAL(9,2) ENCODE ZSTD,
  ADM_ER_ALLOWED_AMT                  DECIMAL(11,0) ENCODE ZSTD,
  ADM_NOT_COVERED_AMT                 DECIMAL(9,2) ENCODE ZSTD,
  ADM_STOP_LOSS_AMT                   DECIMAL(9,2) ENCODE ZSTD,
  ADM_TCRRV_AMT                       DECIMAL(9,2) ENCODE ZSTD,
  ADM_COUNT                           INT ENCODE ZSTD,
  SRC_ID                              VARCHAR(2) NULL ENCODE ZSTD,
  LOAD_DT_TIME                        DATETIME NULL ENCODE ZSTD,
  MEMBER_ID_ENC                       VARCHAR(25) NOT NULL ENCODE ZSTD,
  MEMBER_CONSU_IQ_KEY                 VARCHAR(32) NOT NULL ENCODE RAW,
  HPD_DISEASE_KEY                     VARCHAR(32) NOT NULL ENCODE RAW,
  ELIGIBILITY_IND_KEY                 VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_AGE                          SMALLINT ENCODE ZSTD,
  SES_INDEX_LVL                       NUMERIC(1,0),
  APR_CMI                             DECIMAL(7,4) ENCODE ZSTD,
  ADM_ADMIT_SEVERITY_IDX              DECIMAL(11,2) ENCODE ZSTD,
  ADJUDICATED_DT                      DATE NULL ENCODE ZSTD,
  RESP_PRVDR_KEY                      VARCHAR(32) NOT NULL ENCODE RAW,
  LOCAL_PLAN_MKT_CD                   VARCHAR(6),
  PROC_KEY                            VARCHAR(32),
  ADM_LOS_DAYS                        SMALLINT ENCODE ZSTD
)
DISTKEY (Member_Demographic_key) INTERLEAVED SORTKEY (adm_paid_dt,admit_dt,adm_discharge_dt);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_PK PRIMARY KEY (ADM_ID);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_PROVIDER_DIM_FK FOREIGN KEY (FACILITY_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_PROVIDER_DIM_FK1 FOREIGN KEY (PRIMARY_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_MEMBER_DIM_FK FOREIGN KEY (MEMBER_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DIM (MEMBER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_MEMBER_DEMOGRAPHIC_DIM_FK FOREIGN KEY (MEMBER_DEMOGRAPHIC_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DEMOGRAPHIC_DIM (MEMBER_DEMOGRAPHIC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_PLAN_DIM_FK FOREIGN KEY (PLAN_KEY) REFERENCES sartpappl_aetna_20181016_new.PLAN_DIM (PLAN_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_GROUP_DIM_FK FOREIGN KEY (GROUP_KEY) REFERENCES sartpappl_aetna_20181016_new.GROUP_DIM (GROUP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_PROVIDER_ADDRESS_DIM_FK FOREIGN KEY (FACILITY_PRVDR_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_PROVIDER_ADDRESS_DIM_FK1 FOREIGN KEY (PRIMARY_PRVDR_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_ADMISSION_CLINICAL_DIM_FK FOREIGN KEY (ADMISSION_CLINICAL_KEY) REFERENCES sartpappl_aetna_20181016_new.ADMISSION_CLINICAL_DIM (ADM_CLINICAL_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_READMISSIONS_DIM_FK FOREIGN KEY (ADMISSIONS_KEY) REFERENCES sartpappl_aetna_20181016_new.READMISSIONS_DIM (ADMISSIONS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_DRG_GROUPER_DIM_FK FOREIGN KEY (DRG_GROUPER_KEY) REFERENCES sartpappl_aetna_20181016_new.DRG_GROUPER_DIM (DRG_GROUPER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_PROVIDER_DIM_FK2 FOREIGN KEY (BILLING_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_PROVIDER_DIM_FK3 FOREIGN KEY (REFERRING_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_PROVIDER_ADDRESS_DIM_FK2 FOREIGN KEY (BILLING_PRVDR_ADDRESS_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_ADDRESS_DIM (PRVDR_ADDRESS_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_MEMBER_EMPLOYMENT_DIM_FK FOREIGN KEY (MEMBER_EMPLOYMENT_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_EMPLOYMENT_DIM (MEMBER_EMPLOYMENT_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_JOB_DIM_FK FOREIGN KEY (JOB_KEY) REFERENCES sartpappl_aetna_20181016_new.JOB_DIM (JOB_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_FAMILY_DIM_FK FOREIGN KEY (FAMILY_KEY) REFERENCES sartpappl_aetna_20181016_new.FAMILY_DIM (FAMILY_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_MEMBER_CLINICAL_DIM_FK FOREIGN KEY (MEMBER_CLINICAL_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CLINICAL_DIM (MEMBER_CLINICAL_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_MEMBER_IND_DIM_FK FOREIGN KEY (MEMBER_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_IND_DIM (MEMBER_IND_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_CLAIM_NETWORK_DIM_FK FOREIGN KEY (CLAIM_NETWORK_KEY) REFERENCES sartpappl_aetna_20181016_new.CLAIM_NETWORK_DIM (CLAIM_NETWORK_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_CARRIER_DIM_FK FOREIGN KEY (CARRIER_KEY) REFERENCES sartpappl_aetna_20181016_new.CARRIER_DIM (CARRIER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_HEALTH_PROFILE_DISEASE_DIM_FK FOREIGN KEY (HPD_DISEASE_KEY) REFERENCES sartpappl_aetna_20181016_new.HEALTH_PROFILE_DISEASE_DIM (HPD_DISEASE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_ELIGIBILITY_IND_DIM_FK FOREIGN KEY (ELIGIBILITY_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.ELIGIBILITY_INDICATOR_DIM (ELIGIBILITY_INDICATOR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_PROVIDER_DIM_FK4 FOREIGN KEY (RESP_PRVDR_KEY) REFERENCES sartpappl_aetna_20181016_new.PROVIDER_DIM (PRVDR_KEY);

COMMIT;

----------------------------------------------------------------------------------
--------                                                                                                   CONSUMER_IQ
----------------------------------------------------------------------------------
CREATE TABLE sartpappl_aetna_20181016_new.MEMBER_CONSU_IQ_DIM
(
  MEMBER_CONSUMER_IQ_KEY   VARCHAR(32) NOT NULL ENCODE RAW,
  SEGMENT_AF               CHAR(1) NULL ENCODE ZSTD,
  SEGMENT_DESC             VARCHAR(25) NULL ENCODE ZSTD,
  SEGMENT_ROLLUP           VARCHAR(25) NULL ENCODE ZSTD,
  LOAD_DT_TIME             TIMESTAMP ENCODE ZSTD
)
DISTSTYLE ALL SORTKEY (MEMBER_CONSUMER_IQ_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.member_consu_iq_dim ADD CONSTRAINT member_consu_iq_dim_pk PRIMARY KEY (MEMBER_CONSUMER_IQ_KEY);

COMMIT;

----------------------------------------------------------------------------------
--------
----------------------------------------------------------------------------------
CREATE TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT
(
  MEMBER_DEMOGRAPHIC_KEY          VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_KEY                      VARCHAR(32) NOT NULL ENCODE RAW,
  ELIG_DT                         DATETIME NOT NULL ENCODE RAW,
  COMMUNITY_ID                    VARCHAR(10) NOT NULL ENCODE ZSTD,
  PLAN_KEY                        VARCHAR(32) NOT NULL ENCODE RAW,
  MEMBER_AGE                      SMALLINT NOT NULL ENCODE ZSTD,
  CARRIER_KEY                     VARCHAR(32) NOT NULL ENCODE ZSTD,
  MEMBER_EMPLOYMENT_KEY           VARCHAR(32) NOT NULL ENCODE ZSTD,
  FAMILY_KEY                      VARCHAR(32) NOT NULL ENCODE ZSTD,
  GROUP_KEY                       VARCHAR(32) NOT NULL ENCODE ZSTD,
  JOB_KEY                         VARCHAR(32) NOT NULL ENCODE ZSTD,
  MEMBER_IND_KEY                  VARCHAR(32) NOT NULL ENCODE ZSTD,
  MED_PAID_PMPM_BM                NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_ER_VISITS_PER_1000_BM       NUMERIC(10,5) NULL ENCODE ZSTD,
  LOAD_DT_TIME                    DATETIME NULL ENCODE ZSTD,
  MEMBER_CONSU_IQ_KEY             VARCHAR(32) NOT NULL ENCODE RAW,
  HPD_DISEASE_KEY                 VARCHAR(32) NOT NULL ENCODE RAW,
  ELIGIBILITY_IND_KEY             VARCHAR(32) NOT NULL ENCODE RAW,
  SES_INDEX_LVL                   NUMERIC(1,0) NULL,
  LOCAL_PLAN_MKT_CD               VARCHAR(6) NULL,
  MED_ALLOWED_PMPM_BM             NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_INPT_PAID_PMPM_BM           NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_INPT_ALLOWED_PMPM_BM        NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_AMB_PAID_PMPM_BM            NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_AMB_ALLOWED_PMPM_BM         NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_ER_PAID_PMPM_BM             NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_ER_ALLOWED_PMPM_BM          NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_SPLTY_PHY_PAID_PMPM_BM      NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_SPLTY_PHY_ALLOWED_PMPM_BM   NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_PCP_PHY_PAID_PMPM_BM        NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_PCP_PHY_ALLOWED_PMPM_BM     NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_RAD_PAID_PMPM_BM            NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_RAD_ALLOWED_PMPM_BM         NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_LAB_PAID_PMPM_BM            NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_LAB_ALLOWED_PMPM_BM         NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_HH_PAID_PMPM_BM             NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_HH_ALLOWED_PMPM_BM          NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_BH_PAID_PMPM_BM             NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_BH_ALLOWED_PMPM_BM          NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_RX_PAID_PMPM_BM             NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_RX_ALLOWED_PMPM_BM          NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_INN_PAID_PERCENT_BM         NUMERIC(10,5) NULL ENCODE ZSTD,
  MED_OON_PAID_PERCENT_BM         NUMERIC(10,5) NULL ENCODE ZSTD,
  LAB_INN_PAID_PMPM_BM            NUMERIC(10,5) NULL ENCODE ZSTD,
  LAB_OON_PAID_PMPM_BM            NUMERIC(10,5) NULL ENCODE ZSTD,
  LAB_OON_NELECT_PAID_PMPM_BM     NUMERIC(10,5) NULL ENCODE ZSTD,
  LAB_OON_ELECT_PAID_PMPM_BM      NUMERIC(10,5) NULL ENCODE ZSTD,
  BH_INN_PAID_PMPM_BM             NUMERIC(10,5) NULL ENCODE ZSTD,
  BH_OON_PAID_PMPM_BM             NUMERIC(10,5) NULL ENCODE ZSTD,
  BH_OON_NELEC_PAID_PMPM_BM       NUMERIC(10,5) NULL ENCODE ZSTD,
  BH_OON_ELEC_PAID_PMPM_BM        NUMERIC(10,5) NULL ENCODE ZSTD,
  AMB_INN_PAID_PMPM_BM            NUMERIC(10,5) NULL ENCODE ZSTD,
  AMB_OON_PAID_PMPM_BM            NUMERIC(10,5) NULL ENCODE ZSTD,
  AMB_OON_ELECT_PAID_PMPM_BM      NUMERIC(10,5) NULL ENCODE ZSTD,
  AMB_OON_NELECT_PAID_PMPM_BM     NUMERIC(10,5) NULL ENCODE ZSTD
)
DISTKEY (Member_Demographic_key) SORTKEY (elig_dt);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_PK PRIMARY KEY (MEMBER_DEMOGRAPHIC_KEY,MEMBER_KEY,ELIG_DT,COMMUNITY_ID,PLAN_KEY,MEMBER_AGE);

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_MEMBER_DEMOGRAPHIC_DIM_FK FOREIGN KEY (MEMBER_DEMOGRAPHIC_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DEMOGRAPHIC_DIM (MEMBER_DEMOGRAPHIC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_PLAN_DIM_FK FOREIGN KEY (PLAN_KEY) REFERENCES sartpappl_aetna_20181016_new.PLAN_DIM (PLAN_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_MEMBER_DIM_FK FOREIGN KEY (MEMBER_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DIM (MEMBER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_MEMBER_DEMOGRAPHIC_DIM_FK1 FOREIGN KEY (MEMBER_DEMOGRAPHIC_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_DEMOGRAPHIC_DIM (MEMBER_DEMOGRAPHIC_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_MEMBER_EMPLOYMENT_DIM_FK FOREIGN KEY (MEMBER_EMPLOYMENT_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_EMPLOYMENT_DIM (MEMBER_EMPLOYMENT_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_FAMILY_DIM_FK FOREIGN KEY (FAMILY_KEY) REFERENCES sartpappl_aetna_20181016_new.FAMILY_DIM (FAMILY_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_GROUP_DIM_FK FOREIGN KEY (GROUP_KEY) REFERENCES sartpappl_aetna_20181016_new.GROUP_DIM (GROUP_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_JOB_DIM_FK FOREIGN KEY (JOB_KEY) REFERENCES sartpappl_aetna_20181016_new.JOB_DIM (JOB_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_MEMBER_IND_DIM_FK FOREIGN KEY (MEMBER_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_IND_DIM (MEMBER_IND_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_CARRIER_DIM_FK FOREIGN KEY (CARRIER_KEY) REFERENCES sartpappl_aetna_20181016_new.CARRIER_DIM (CARRIER_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_HEALTH_PROFILE_DISEASE_DIM_FK FOREIGN KEY (HPD_DISEASE_KEY) REFERENCES sartpappl_aetna_20181016_new.HEALTH_PROFILE_DISEASE_DIM (HPD_DISEASE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_ELIGIBILITY_IND_DIM_FK FOREIGN KEY (ELIGIBILITY_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.ELIGIBILITY_INDICATOR_DIM (ELIGIBILITY_INDICATOR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_BOB_FCT ADD CONSTRAINT MEMBER_BOB_FCT_MEMBER_CONSU_IQ_DIM_FK FOREIGN KEY (MEMBER_CONSU_IQ_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CONSU_IQ_DIM (MEMBER_CONSUMER_IQ_KEY);

COMMIT;

---Table CONSTRAINT--------
ALTER TABLE sartpappl_aetna_20181016_new.ADMISSION_FCT ADD CONSTRAINT ADMISSION_FCT_MEMBER_CONSU_IQ_DIM_FK FOREIGN KEY (MEMBER_CONSU_IQ_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CONSU_IQ_DIM (MEMBER_CONSUMER_IQ_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.VIS_CLAIMS_FCT ADD CONSTRAINT VIS_CLAIMS_FCT_MEMBER_CONSU_IQ_DIM_FK FOREIGN KEY (MEMBER_CONSU_IQ_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CONSU_IQ_DIM (MEMBER_CONSUMER_IQ_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PREDICTIVE_MODEL_FCT ADD CONSTRAINT MEMBER_PREDICTIVE_MODEL_FCT_MEMBER_CONSU_IQ_DIM_FK FOREIGN KEY (MEMBER_CONSU_IQ_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CONSU_IQ_DIM (MEMBER_CONSUMER_IQ_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.ETG_EPISODE_FCT ADD CONSTRAINT ETG_EPISODE_FCT_MEMBER_CONSU_IQ_DIM_FK FOREIGN KEY (MEMBER_CONSU_IQ_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CONSU_IQ_DIM (MEMBER_CONSUMER_IQ_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_MEMBER_CONSU_IQ_DIM_FK FOREIGN KEY (MEMBER_CONSU_IQ_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CONSU_IQ_DIM (MEMBER_CONSUMER_IQ_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_HEALTH_PROFILE_DISEASE_DIM_FK FOREIGN KEY (HPD_DISEASE_KEY) REFERENCES sartpappl_aetna_20181016_new.HEALTH_PROFILE_DISEASE_DIM (HPD_DISEASE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.DENTAL_CLAIMS_FCT ADD CONSTRAINT DENTAL_CLAIMS_FCT_ELIGIBILITY_IND_DIM_FK FOREIGN KEY (ELIGIBILITY_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.ELIGIBILITY_INDICATOR_DIM (ELIGIBILITY_INDICATOR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_EPISODE_DIM_FK FOREIGN KEY (EPISODE_KEY) REFERENCES sartpappl_aetna_20181016_new.EPISODE_DIM (EPISODE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_MEMBER_CONSU_IQ_DIM_FK FOREIGN KEY (MEMBER_CONSU_IQ_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CONSU_IQ_DIM (MEMBER_CONSUMER_IQ_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_HEALTH_PROFILE_DISEASE_DIM_FK FOREIGN KEY (HPD_DISEASE_KEY) REFERENCES sartpappl_aetna_20181016_new.HEALTH_PROFILE_DISEASE_DIM (HPD_DISEASE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEDICAL_CLAIMS_FCT ADD CONSTRAINT MEDICAL_CLAIMS_FCT_ELIGIBILITY_IND_DIM_FK FOREIGN KEY (ELIGIBILITY_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.ELIGIBILITY_INDICATOR_DIM (ELIGIBILITY_INDICATOR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_EPISODE_DIM_FK FOREIGN KEY (EPISODE_KEY) REFERENCES sartpappl_aetna_20181016_new.EPISODE_DIM (EPISODE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_MEMBER_CONSU_IQ_DIM_FK FOREIGN KEY (MEMBER_CONSU_IQ_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CONSU_IQ_DIM (MEMBER_CONSUMER_IQ_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_HEALTH_PROFILE_DISEASE_DIM_FK FOREIGN KEY (HPD_DISEASE_KEY) REFERENCES sartpappl_aetna_20181016_new.HEALTH_PROFILE_DISEASE_DIM (HPD_DISEASE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.PHARMACY_CLAIMS_FCT ADD CONSTRAINT PHARMACY_CLAIMS_FCT_ELIGIBILITY_IND_DIM_FK FOREIGN KEY (ELIGIBILITY_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.ELIGIBILITY_INDICATOR_DIM (ELIGIBILITY_INDICATOR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_HEALTH_PROFILE_DISEASE_DIM_FK FOREIGN KEY (HPD_DISEASE_KEY) REFERENCES sartpappl_aetna_20181016_new.HEALTH_PROFILE_DISEASE_DIM (HPD_DISEASE_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_ELIGIBILITY_IND_DIM_FK FOREIGN KEY (ELIGIBILITY_IND_KEY) REFERENCES sartpappl_aetna_20181016_new.ELIGIBILITY_INDICATOR_DIM (ELIGIBILITY_INDICATOR_KEY);

COMMIT;

ALTER TABLE sartpappl_aetna_20181016_new.MEMBER_PLAN_ENROLLMENT_FCT ADD CONSTRAINT MEMBER_PLAN_ENROLLMENT_FCT_MEMBER_CONSU_IQ_DIM_FK FOREIGN KEY (MEMBER_CONSU_IQ_KEY) REFERENCES sartpappl_aetna_20181016_new.MEMBER_CONSU_IQ_DIM (MEMBER_CONSUMER_IQ_KEY);

COMMIT;

